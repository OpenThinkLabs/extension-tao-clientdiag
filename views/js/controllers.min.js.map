{"version":3,"sources":["routes.js","../tools/fixedDecimals.js","../tools/stats.js","../../taoQtiItem/qtiItem/core/qtiClasses.js","../../taoQtiItem/qtiItem/helper/util.js","../../taoQtiItem/qtiItem/helper/rendererConfig.js","../../taoQtiItem/qtiItem/core/Element.js","../../taoQtiItem/qtiItem/core/Loader.js","../../taoQtiItem/qtiItem/helper/interactionHelper.js","../../taoQtiItem/qtiRunner/core/Renderer.js","../../taoItems/assets/manager.js","../../taoItems/assets/strategies.js","../../taoQtiItem/qtiCommonRenderer/renderers/config.js","../../taoQtiItem/qtiCommonRenderer/renderers/Renderer.js","../../lib/polyfill/performance-now.js","../tools/performances/tester.js","../tools/bandwidth/tester.js","CompatibilityChecker/diagnostics.js"],"names":["define","CompatibilityChecker","actions","index","fixedDecimals","value","decimals","shift","Math","pow","abs","round","Number","_","stats","list","fieldName","variance","avg","med","middle","getValue","results","sum","sum2","min","MAX_VALUE","max","count","values","isFunction","item","forEach","undefined","push","diff","sqrt","sort","floor","ceil","average","median","key","_container","assessmentItem","responseProcessing","_simpleFeedbackRule","stylesheet","math","img","object","outcomeDeclaration","responseDeclaration","rubricBlock","associableHotspot","gap","gapImg","gapText","hotspotChoice","hottext","inlineChoice","simpleAssociableChoice","simpleChoice","associateInteraction","choiceInteraction","endAttemptInteraction","extendedTextInteraction","gapMatchInteraction","graphicAssociateInteraction","graphicGapMatchInteraction","graphicOrderInteraction","hotspotInteraction","hottextInteraction","inlineChoiceInteraction","matchInteraction","mediaInteraction","orderInteraction","prompt","selectPointInteraction","sliderInteraction","textEntryInteraction","uploadInteraction","feedbackBlock","feedbackInline","modalFeedback","customInteraction","infoControl","include","util","buildSerial","prefix","id","chars","i","charAt","random","length","buildId","usedIds","suffix","exists","TypeError","getUsedIds","contains","buildIdentifier","useSuffix","getUsedIdentifiers","isUndefined","replace","this","qtiClass","findInCollection","element","collectionNames","searchedSerial","found","isString","isArray","Error","each","collectionName","collection","split","nameToken","elt","parent","find","addMarkupNamespace","markup","ns","$0","$1","$2","$3","$4","indexOf","removeMarkupNamespaces","getMarkupUsedNamespaces","namespaces","original","slash","node","uniq","$","rendererConfigHelper","getOptionsFromArguments","args","options","data","placeholder","subclass","renderer","arg","isRenderer","isPlainObject","console","log","Class","rendererConfig","_instances","Element","extend","serial","relatedItem","init","attributes","metaData","match","setAttributes","initContainer","arguments","initObject","is","getSerial","elts","getComposingElements","attr","name","prop","document","trigger","removeData","removeAttr","removeAttributes","getAttributes","clone","attrNames","append","getBody","getObject","v","isA","getUsedClasses","ret","composingElts","location","getRelatedItem","setRelatedItem","recursive","setRenderer","getRenderer","render","_renderer","tplData","defaultData","tag","body","resolveUrl","merge","getData","rendering","renderTpl","replaceWith","postRender","altClassName","postRenderers","compact","getContainer","$scope","toArray","arr","type","isEmpty","addClass","className","clazz","_containClass","hasClass","removeClass","regex","RegExp","trim","toggleClass","state","isset","issetElement","unset","unsetElement","allClassStr","test","qtiElement","getElementBySerial","composingElements","qtiClasses","loadPortableCustomElementData","portableElement","typeIdentifier","entryPoint","properties","libraries","Loader","classesLocation","qti","setClassesLocation","getRequiredClasses","union","loadRequiredClasses","callback","reload","requiredClasses","required","requiredClass","_this","require","QtiClass","prototype","call","getLoadedClasses","keys","loadItemData","Qti","loadContainer","outcomes","outcome","buildOutcome","addOutcomeDeclaration","feedbacks","feedback","buildElement","addModalFeedback","stylesheets","addStylesheet","responses","response","buildResponse","addResponseDeclaration","feedbackRules","forIn","fbData","buildSimpleFeedbackRule","setResponseProcessing","buildResponseProcessing","setNamespaces","loadAndBuildElement","loadElement","loadElementData","loadElements","allElements","elementData","template","howMatch","defaultValue","correctResponse","correctResponses","size","mapping","mapEntries","areaMapping","mappingAttributes","feedbackRule","condition","comparedValue","comparedOutcome","feedbackOutcome","feedbackThen","modalFeedbacks","feedbackElse","rp","processingType","xml","bodyObject","bodyData","elements","eltData","setElement","defaults","bdy","loadObjectData","loadInteractionData","loadChoiceData","loadMathData","loadPicData","interaction","buildInteractionChoices","loadPciData","choices","set","matchSet","choice","addChoice","gapImgs","addGapImg","val","text","_alt","setMathML","mathML","annotations","encoding","setAnnotation","pci","pic","convertChoices","outputType","c","findChoices","inputType","getChoice","getChoiceByIdentifier","shuffleChoices","r","f","j","n","k","tmp","serialToIdentifier","choiceSerial","Handlebars","Promise","interactionHelper","themeLoader","getDocumentBaseUrl","window","protocol","host","pathname","_isValidRenderer","valid","classCorrect","_renderableClasses","pos","slice","subClass","_renderableSubclasses","_dependencies","_defaults","Renderer","_locations","_renderers","shuffledChoices","_getClassRenderer","setOption","setOptions","opts","getOption","getAssetManager","assetManager","getThemeLoader","qtiSubclass","res","decorators","isObject","before","after","renderDirect","tpl","compile","setResponse","qtiInteraction","$container","getResponse","resetResponse","getState","setState","destroy","getLoadedRenderers","register","renderersLocations","load","self","themes","base","available","theme","path","intersection","reqClass","deps","requiredSubClasses","unload","setShuffledChoices","identificationType","pluck","getShuffledChoices","reshuffle","returnedType","getChoices","getRenderers","getLocations","url","resolve","getAbsoluteUrl","relUrl","warn","absUrl","runtimeLocations","runtimeLocation","baseUrl","build","defaultOptions","NewRenderer","apply","urlUtil","assetManagerFactory","strategies","cache","parseUrl","_strategies","addStrategy","strategy","handle","setStrategies","newStrategies","setData","resolved","inputUrl","hasOwnProperty","parse","result","resolveBy","clearCache","isRelative","slashcat","directory","encodeURIComponent","file","external","isAbsolute","toString","base64","isBase64","taomedia","context","assetStrategies","itemThemes","get","portableAssetStrategy","source","relative","root_url","locations","simpleChoice.choiceInteraction","simpleChoice.orderInteraction","simpleAssociableChoice.matchInteraction","simpleAssociableChoice.associateInteraction","config","performance","Date","now","getTime","nowOffset","timing","navigationStart","async","helpers","loadItem","done","qtiJsonFile","urlTokens","extension","fullpath","s","contexts","paths","loader","itemData","duration","start","end","appendTo","remove","_second","_defaultTimeout","_defaultOccurrencesCount","_defaultSamples","_sampleBaseId","performancesTester","samples","occurrences","timeout","idx","_samples","map","sample","nb","tests","cb","partial","iterations","series","err","measures","_kilo","_mega","_downloadData","10KB","threshold","100KB","1MB","10MB","100MB","download","timeoutId","request","bandwidth","XMLHttpRequest","open","setRequestHeader","onload","bytes","seconds","speed","clearTimeout","onerror","delay","send","bandwidthTester","bind","__","loadingBar","displayTestResult","status","$bar","$indicator","message","isNumber","label","fadeIn","animate","left","percentage","outerWidth","updateTestResult","score","displaySummary","total","getStatus","summaryThresholds","checkBrowser","info","WhichBrowser","browser","os","information","browserVersion","version","osVersion","alias","post","_url","storeData","details","omit","checkBandwidth","unit","bandwidthUnit","tt","ideal","testTakers","maxTT","maxTestTakers","st","bandwidthThresholds","checkPerformance","optimal","performanceOptimal","range","performanceThreshold","cursor","thresholds","displayDetails","$detailsTable","empty","line","step","len","getResultConfig","$result","$testTriggerBtn","$detailsBtn","scores","$feedbackBox","on","hide","assign","performancesMin","performancesMax","performancesAverage","bandwidthMin","bandwidthMax","bandwidthAverage","stop","error"],"mappings":"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,aAAApe,KAAA,UAEAoe,aAAApe,KAAA,YACAiI,WAAA8W,MAAAX,aAAApe,KAAA,YAOA,OAAAgB;AfvYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3GA,AD4GA;AC3GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpMA,ADqMA;ACpMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClCA,ADmCA;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC/bA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACrGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3uBA,AD4uBA;AC3uBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AClHA,ADmHA;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7BA,AD8BA;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACzMA,AD0MA;ACzMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"taoClientDiagnostic/controller/routes.js","sourcesContent":["define('taoClientDiagnostic/controller/routes',[],function(){\n    return {\n        'CompatibilityChecker' : {\n            'actions' : {\n                'index' : 'controller/compatibilityChecker/index'\n            }\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoClientDiagnostic/tools/fixedDecimals',[],function () {\n    'use strict';\n\n    /**\n     * Rounds a value to a fixed number of decimals\n     * @param {Number} value The value to round\n     * @param {Number} decimals The number of decimal\n     * @returns {Number}\n     */\n    var fixedDecimals = function fixedDecimals(value, decimals) {\n        var shift = Math.pow(10, Math.abs(decimals || 1));\n        return Math.round(Number(value) * shift) / shift || 0;\n    };\n\n    return fixedDecimals;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoClientDiagnostic/tools/stats',[\n    'lodash',\n    'taoClientDiagnostic/tools/fixedDecimals'\n], function (_, fixedDecimals) {\n    'use strict';\n\n    /**\n     * Computes some stats on a list from a particular field\n     * @param {Array|Object} list The list to compute stats on\n     * @param {String|Function} fieldName The name of the field to process, or a callback method returning the value\n     * @param {Number} [decimals] Optional number of fixed decimals for values\n     * @returns {{min: Number, max: Number, sum: Number, count: Number, average: Number, median: Number, variance: Number, values: *}}\n     */\n    var stats = function stats(list, fieldName, decimals) {\n        var sum = 0;\n        var sum2 = 0;\n        var min = Number.MAX_VALUE;\n        var max = 0;\n        var variance;\n        var count = 0;\n        var values = [];\n        var avg;\n        var med;\n        var middle;\n        var getValue;\n        var results;\n\n        if (_.isFunction(fieldName)) {\n            getValue = fieldName;\n        } else {\n            getValue = function(item) {\n                return item && item[fieldName] || 0;\n            };\n        }\n\n        // process 1st pass stats: compute sum, min and max values\n        _.forEach(list, function(item) {\n            var value;\n            if (undefined !== item) {\n                value = getValue(item);\n                values.push(value);\n                min = Math.min(min, value);\n                max = Math.max(max, value);\n                sum += value;\n                count++;\n            }\n        });\n\n        // compute the average value\n        avg = sum / (count || 1);\n\n        // process 2nd pass stats: compute variance\n        _.forEach(values, function(value) {\n            var diff = value - avg;\n            sum2 += diff * diff;\n        });\n\n        // compute de standard variance\n        variance = count > 1 ? Math.sqrt(sum2 / (count - 1)) : 0;\n\n        // compute the median value\n        values.sort();\n        middle = count / 2;\n        med = (values[Math.floor(middle)] + values[Math.ceil(middle)]) / 2;\n\n        results = {\n            min : min,\n            max : max,\n            sum : sum,\n            count : count,\n            average : avg,\n            median : med,\n            variance : variance\n        };\n\n        if (decimals) {\n            _.forEach(results, function(value, key) {\n                results[key] = fixedDecimals(value, decimals);\n            });\n        }\n\n        results.values = list;\n        return results;\n    };\n\n    return stats;\n});\n\n","define('taoQtiItem/qtiItem/core/qtiClasses',[], function(){\n    return {\n        '_container' : 'taoQtiItem/qtiItem/core/Container',\n        'assessmentItem' : 'taoQtiItem/qtiItem/core/Item',\n        'responseProcessing' : 'taoQtiItem/qtiItem/core/ResponseProcessing',\n        '_simpleFeedbackRule' : 'taoQtiItem/qtiItem/core/response/SimpleFeedbackRule',\n        'stylesheet' : 'taoQtiItem/qtiItem/core/Stylesheet',\n        'math' : 'taoQtiItem/qtiItem/core/Math',\n        'img' : 'taoQtiItem/qtiItem/core/Img',\n        'object' : 'taoQtiItem/qtiItem/core/Object',\n        'outcomeDeclaration' : 'taoQtiItem/qtiItem/core/variables/OutcomeDeclaration',\n        'responseDeclaration' : 'taoQtiItem/qtiItem/core/variables/ResponseDeclaration',\n        'rubricBlock' : 'taoQtiItem/qtiItem/core/RubricBlock',\n        'associableHotspot' : 'taoQtiItem/qtiItem/core/choices/AssociableHotspot',\n        'gap' : 'taoQtiItem/qtiItem/core/choices/Gap',\n        'gapImg' : 'taoQtiItem/qtiItem/core/choices/GapImg',\n        'gapText' : 'taoQtiItem/qtiItem/core/choices/GapText',\n        'hotspotChoice' : 'taoQtiItem/qtiItem/core/choices/HotspotChoice',\n        'hottext' : 'taoQtiItem/qtiItem/core/choices/Hottext',\n        'inlineChoice' : 'taoQtiItem/qtiItem/core/choices/InlineChoice',\n        'simpleAssociableChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleAssociableChoice',\n        'simpleChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleChoice',\n        'associateInteraction' : 'taoQtiItem/qtiItem/core/interactions/AssociateInteraction',\n        'choiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/ChoiceInteraction',\n        'endAttemptInteraction' : 'taoQtiItem/qtiItem/core/interactions/EndAttemptInteraction',\n        'extendedTextInteraction' : 'taoQtiItem/qtiItem/core/interactions/ExtendedTextInteraction',\n        'gapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GapMatchInteraction',\n        'graphicAssociateInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicAssociateInteraction',\n        'graphicGapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicGapMatchInteraction',\n        'graphicOrderInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicOrderInteraction',\n        'hotspotInteraction' : 'taoQtiItem/qtiItem/core/interactions/HotspotInteraction',\n        'hottextInteraction' : 'taoQtiItem/qtiItem/core/interactions/HottextInteraction',\n        'inlineChoiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/InlineChoiceInteraction',\n        'matchInteraction' : 'taoQtiItem/qtiItem/core/interactions/MatchInteraction',\n        'mediaInteraction' : 'taoQtiItem/qtiItem/core/interactions/MediaInteraction',\n        'orderInteraction' : 'taoQtiItem/qtiItem/core/interactions/OrderInteraction',\n        'prompt' : 'taoQtiItem/qtiItem/core/interactions/Prompt',\n        'selectPointInteraction' : 'taoQtiItem/qtiItem/core/interactions/SelectPointInteraction',\n        'sliderInteraction' : 'taoQtiItem/qtiItem/core/interactions/SliderInteraction',\n        'textEntryInteraction' : 'taoQtiItem/qtiItem/core/interactions/TextEntryInteraction',\n        'uploadInteraction' : 'taoQtiItem/qtiItem/core/interactions/UploadInteraction',\n        'feedbackBlock' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackBlock',\n        'feedbackInline' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackInline',\n        'modalFeedback' : 'taoQtiItem/qtiItem/core/feedbacks/ModalFeedback',\n        'customInteraction' : 'taoQtiItem/qtiItem/core/interactions/CustomInteraction',\n        'infoControl' : 'taoQtiItem/qtiItem/core/PortableInfoControl',\n        'include' : 'taoQtiItem/qtiItem/core/Include'\n    };\n});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\n *\n */\n\n/**\n * Common basic util functions\n */\ndefine('taoQtiItem/qtiItem/helper/util',['lodash'], function(_){\n    'use strict';\n\n    var util = {\n\n        buildSerial : function buildSerial(prefix){\n            var id = prefix || '';\n            var chars = \"abcdefghijklmnopqrstuvwxyz0123456789\";\n            for(var i = 0; i < 22; i++){\n                id += chars.charAt(Math.floor(Math.random() * chars.length));\n            }\n            return id;\n        },\n\n        /**\n         * Generates an id for a Qti element (the generation is different from identifier)\n         * @param {Object} item - the element related item\n         * @param {String} prefix - identifier prefix\n         * @returns {String} the identifier\n         * @throws {TypeError} if there is no item\n         */\n        buildId : function buildId(item, prefix){\n            var id;\n            var usedIds;\n            var i = 1;\n            var suffix = '';\n            var exists = false;\n\n            if(!item){\n                throw new TypeError('A item is required to generate a unique identifier');\n            }\n\n            usedIds   = item.getUsedIds();\n\n            do{\n                exists = false;\n                id = prefix + suffix;\n                if(_.contains(usedIds, id)){\n                    exists = true;\n                    suffix = '_' + i;\n                    i++;\n                }\n            } while(exists);\n\n            return id;\n        },\n\n        /**\n         * Generates an identifier for a Qti element\n         * @param {Object} item - the element related item\n         * @param {String} prefix - identifier prefix\n         * @param {Boolean} [useSuffix = true] - add a \"_ + index\" to the identifier\n         * @returns {String} the identifier\n         * @throws {TypeError} if there is no item\n         */\n        buildIdentifier : function buildIdentifier(item, prefix, useSuffix){\n\n            var id;\n            var usedIds;\n            var suffix = '';\n            var i = 1;\n            var exists = false;\n\n            if(!item){\n                throw new TypeError('A item is required to generate a unique identifier');\n            }\n\n            usedIds   = item.getUsedIdentifiers();\n            useSuffix = _.isUndefined(useSuffix) ? true : useSuffix;\n\n            if(prefix){\n                prefix = prefix.replace(/_[0-9]+$/ig, '_') //detect incremental id of type choice_12, response_3, etc.\n                               .replace(/[^a-zA-Z0-9_]/ig, '_')\n                               .replace(/(_)+/ig, '_');\n                if(useSuffix){\n                    suffix = '_' + i;\n                }\n            } else {\n                prefix = this.qtiClass;\n                suffix = '_' + i;\n            }\n\n            do{\n                exists = false;\n                id = prefix + suffix;\n                if(usedIds[id]){\n                    exists = true;\n                    suffix = '_' + i;\n                    i++;\n                }\n            } while(exists);\n\n            return id;\n        },\n\n        findInCollection : function findInCollection(element, collectionNames, searchedSerial){\n\n            var found = null;\n\n            if(_.isString(collectionNames)){\n                collectionNames = [collectionNames];\n            }\n\n            if(_.isArray(collectionNames)){\n\n                _.each(collectionNames, function(collectionName){\n\n                    //get collection to search in (resolving case like interaction.choices.0\n                    var collection = element;\n                    _.each(collectionName.split('.'), function(nameToken){\n                        collection = collection[nameToken];\n                    });\n                    var elt = collection[searchedSerial];\n\n                    if(elt){\n                        found = {'parent' : element, 'element' : elt};\n                        return false;//break the each loop\n                    }\n\n                    //search inside each elements:\n                    _.each(collection, function(elt){\n\n                        if(_.isFunction(elt.find)){\n                            found = elt.find(searchedSerial);\n                            if(found){\n                                return false;//break the each loop\n                            }\n                        }\n\n                    });\n\n                    if(found){\n                        return false;//break the each loop\n                    }\n\n                });\n\n            }else{\n\n                throw new Error('invalid argument : collectionNames must be an array or a string');\n            }\n\n            return found;\n        },\n        addMarkupNamespace : function addMarkupNamespace(markup, ns){\n            if(ns) {\n                markup = markup.replace(/<(\\/)?([a-z:]+)(\\s?)([^><]*)>/g, function($0, $1, $2, $3, $4){\n                    if($2.indexOf(':')>0){\n                        return $0;\n                    }\n                    $1 = $1 || '';\n                    $3 = $3 || '';\n                    return '<'+ $1 + ns + ':'+$2+$3+$4+'>';\n                });\n                return markup;\n            }\n            return markup;\n\n        },\n        removeMarkupNamespaces : function removeMarkupNamespace(markup){\n            return markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, '<$1$3>');\n        },\n        getMarkupUsedNamespaces : function getMarkupUsedNamespaces(markup){\n            var namespaces = [];\n            markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, function(original, slash, ns, node){\n                namespaces.push(ns);\n                return '<'+slash+node+'>';\n            });\n            return _.uniq(namespaces);\n        }\n    };\n\n    return util;\n});\n\n","define('taoQtiItem/qtiItem/helper/rendererConfig',['lodash', 'jquery'], function(_, $){\n\n    var rendererConfigHelper = {};\n\n    rendererConfigHelper.getOptionsFromArguments = function(args){\n\n        var options = {\n            data : {},\n            placeholder : null,\n            subclass : '',\n            renderer : null\n        };\n        \n        _.each(args, function(arg){\n            if(arg){\n                if(arg.isRenderer){\n                    options.renderer = arg;\n                }else if(arg instanceof $ && arg.length){\n                    options.placeholder = arg;\n                }else if(_.isString(arg)){\n                    options.subclass = arg;\n                }else if(_.isPlainObject(arg)){\n                    options.data = arg;\n                }else{\n                    console.log('invalid arg', arg, args);\n                }\n            }\n        });\n        \n        return options;\n    };\n    \n    return rendererConfigHelper;\n});\n\n","\n/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\n *\n */\ndefine('taoQtiItem/qtiItem/core/Element',[\n    'jquery',\n    'lodash',\n    'class',\n    'taoQtiItem/qtiItem/helper/util',\n    'taoQtiItem/qtiItem/helper/rendererConfig'\n], function($, _, Class, util, rendererConfig){\n    'use strict';\n\n    var _instances = {};\n\n    var Element = Class.extend({\n        qtiClass : '',\n        serial : '',\n        relatedItem : null,\n        init : function(serial, attributes){\n\n            //init own attributes\n            this.attributes = {};\n\n            //system properties, for item creator internal use only\n            this.metaData = {};\n\n            //init call in the format init(attributes)\n            if(typeof (serial) === 'object'){\n                attributes = serial;\n                serial = '';\n            }\n\n            if(!serial){\n                serial = util.buildSerial(this.qtiClass + '_');\n            }\n\n            if(serial && (typeof serial !== 'string' || !serial.match(/^[a-z_0-9]*$/i))){\n                throw 'invalid QTI serial : (' + (typeof serial) + ') ' + serial;\n            }\n\n            if(!_instances[serial]){\n                _instances[serial] = this;\n                this.serial = serial;\n                this.setAttributes(attributes || {});\n            }else{\n                throw 'a QTI Element with the same serial already exists ' + serial;\n            }\n\n            if(typeof this.initContainer === 'function'){\n                this.initContainer(arguments[2] || '');\n            }\n            if(typeof this.initObject === 'function'){\n                this.initObject();\n            }\n        },\n        is : function(qtiClass){\n            return (qtiClass === this.qtiClass);\n        },\n        placeholder : function(){\n            return '{{' + this.serial + '}}';\n        },\n        getSerial : function(){\n            return this.serial;\n        },\n        getUsedIdentifiers : function(){\n            var usedIds = {};\n            var elts = this.getComposingElements();\n            for(var i in elts){\n                var elt = elts[i];\n                var id = elt.attr('identifier');\n                if(id){\n                    //warning: simplistic implementation, allow only one unique identifier in the item no matter the element class/type\n                    usedIds[id] = elt;\n                }\n            }\n            return usedIds;\n        },\n\n        /**\n         * Get the ids in use. (id is different from identifier)\n         * @returns {Array} of the ids in use\n         */\n        getUsedIds : function getUsedIds(){\n            var usedIds = [];\n            _.forEach(this.getComposingElements(), function(elt){\n                var id = elt.attr('id');\n                if(id && !_.contains(usedIds, id)){\n                    usedIds.push(id);\n                }\n            });\n            return usedIds;\n        },\n\n        attr : function(name, value){\n            if(name){\n                if(value !== undefined){\n                    this.attributes[name] = value;\n                }else{\n                    if(typeof (name) === 'object'){\n                        for(var prop in name){\n                            this.attr(prop, name[prop]);\n                        }\n                    }else if(typeof (name) === 'string'){\n                        if(this.attributes[name] === undefined){\n                            return undefined;\n                        }else{\n                            return this.attributes[name];\n                        }\n                    }\n                }\n            }\n            return this;\n        },\n        data : function(name, value){\n            if(name){\n                if(value !== undefined){\n                    this.metaData[name] = value;\n                    $(document).trigger('metaChange.qti-widget', {element : this, key : name, value : value});\n                }else{\n                    if(typeof (name) === 'object'){\n                        for(var prop in name){\n                            this.data(prop, name[prop]);\n                        }\n                    }else if(typeof (name) === 'string'){\n                        if(this.metaData[name] === undefined){\n                            return undefined;\n                        }else{\n                            return this.metaData[name];\n                        }\n                    }\n                }\n            }\n            return this;\n        },\n        removeData : function(name){\n            delete this.metaData[name];\n            return this;\n        },\n        removeAttr : function(name){\n            return this.removeAttributes(name);\n        },\n        setAttributes : function(attributes){\n            this.attributes = attributes;\n            return this;\n        },\n        getAttributes : function(){\n            return _.clone(this.attributes);\n        },\n        removeAttributes : function(attrNames){\n            if(typeof (attrNames) === 'string'){\n                attrNames = [attrNames];\n            }\n            for(var i in attrNames){\n                delete this.attributes[attrNames[i]];\n            }\n            return this;\n        },\n        getComposingElements : function(){\n            var elts = {};\n            function append(element){\n                elts[element.getSerial()] = element;//pass individual object by ref, instead of the whole list(object)\n                elts = _.extend(elts, element.getComposingElements());\n            }\n            if(typeof this.initContainer === 'function'){\n                append(this.getBody());\n            }\n            if(typeof this.initObject === 'function'){\n                append(this.getObject());\n            }\n            _.each(this.metaData, function(v){\n                if(Element.isA(v, '_container')){\n                    append(v);\n                }else if(_.isArray(v)){\n                    _.each(v, function(v){\n                        if(Element.isA(v, '_container')){\n                            append(v);\n                        }\n                    });\n                }\n            });\n            return elts;\n        },\n        getUsedClasses : function(){\n\n            var ret = [this.qtiClass],\n                composingElts = this.getComposingElements();\n\n            _.each(composingElts, function(elt){\n                ret.push(elt.qtiClass);\n            });\n\n            return _.uniq(ret);\n        },\n        find : function(serial){\n\n            var found = null;\n\n            if(typeof this.initObject === 'function'){\n                var object = this.getObject();\n                if(object.serial === serial){\n                    found = {'parent' : this, 'element' : object, 'location' : 'object'};\n                }\n            }\n\n            if(!found && typeof this.initContainer === 'function'){\n                found = this.getBody().find(serial, this);\n            }\n\n            return found;\n        },\n        parent : function(){\n            var item = this.getRelatedItem();\n            if(item){\n                var found = item.find(this.getSerial());\n                if(found){\n                    return found.parent;\n                }\n            }\n            return null;\n        },\n        setRelatedItem : function(item, recursive){\n\n            recursive = (typeof recursive === 'undefined') ? true : recursive;\n\n            if(Element.isA(item, 'assessmentItem')){\n                this.relatedItem = item;\n                var composingElts = this.getComposingElements();\n                for(var i in composingElts){\n                    composingElts[i].setRelatedItem(item, false);\n                }\n            }\n\n        },\n        getRelatedItem : function(){\n            var ret = null;\n            if(Element.isA(this.relatedItem, 'assessmentItem')){\n                ret = this.relatedItem;\n            }\n            return ret;\n        },\n        setRenderer : function(renderer){\n            if(renderer && renderer.isRenderer){\n                this.renderer = renderer;\n                var elts = this.getComposingElements();\n                for(var serial in elts){\n                    elts[serial].setRenderer(renderer);\n                }\n            }else{\n                throw 'invalid qti rendering engine';\n            }\n        },\n        getRenderer : function(){\n            return this.renderer;\n        },\n        render : function(){\n\n            var args = rendererConfig.getOptionsFromArguments(arguments);\n            var _renderer = args.renderer || this.getRenderer();\n\n            var tplData = {},\n                defaultData = {\n                    'tag' : this.qtiClass,\n                    'serial' : this.serial,\n                    'attributes' : this.getAttributes()\n                };\n\n            if(!_renderer){\n                throw 'render: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n\n            if(typeof this.initContainer === 'function'){\n                //allow body to have a different renderer if it has its own renderer set\n                defaultData.body = this.getBody().render(args.renderer);\n            }\n            if(typeof this.initObject === 'function'){\n                defaultData.object = {\n                    attributes : this.object.getAttributes()\n                };\n                defaultData.object.attributes.data = _renderer.resolveUrl(this.object.attr('data'));\n            }\n\n            tplData = _.merge(defaultData, args.data || {});\n            tplData = _renderer.getData(this, tplData, args.subclass);\n            var rendering = _renderer.renderTpl(this, tplData, args.subclass);\n            if(args.placeholder){\n                args.placeholder.replaceWith(rendering);\n            }\n\n            return rendering;\n        },\n        postRender : function(data, altClassName, renderer){\n\n            var postRenderers = [];\n            var _renderer = renderer || this.getRenderer();\n\n            if(typeof this.initContainer === 'function'){\n                //allow body to have a different renderer if it has its own renderer set\n                postRenderers = this.getBody().postRender({}, '', renderer);\n            }\n\n            if(_renderer){\n                postRenderers.push(_renderer.postRender(this, data, altClassName));\n            }else{\n                throw 'postRender: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n\n            return _.compact(postRenderers);\n        },\n        getContainer : function($scope, subclass){\n            var renderer = this.getRenderer();\n            if(renderer){\n                return renderer.getContainer(this, $scope, subclass);\n            }else{\n                throw 'getContainer: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\n            }\n        },\n        toArray : function(){\n            var arr = {\n                serial : this.serial,\n                type : this.qtiClass,\n                attributes : this.getAttributes()\n            };\n\n            if(typeof this.initContainer === 'function'){\n                arr.body = this.getBody().toArray();\n            }\n            if(typeof this.initObject === 'function'){\n                arr.object = this.object.toArray();\n            }\n\n            return arr;\n        },\n        isEmpty : function(){\n            //tells whether the element should be considered empty or not, from the rendering point of view\n            return false;\n        },\n        addClass : function(className){\n            var clazz = this.attr('class') || '';\n            if(!_containClass(clazz, className)){\n                this.attr('class', clazz + (clazz.length ? ' ' : '') + className);\n            }\n        },\n        hasClass : function(className){\n            return _containClass(this.attr('class'), className);\n        },\n        removeClass : function(className){\n\n            var clazz = this.attr('class') || '';\n            if(clazz){\n\n                var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)');\n                clazz = clazz.replace(regex, ' ').trim();\n\n                if(clazz){\n                    this.attr('class', clazz);\n                }else{\n                    this.removeAttr('class');\n                }\n            }\n        },\n        /**\n         * Add or remove class. Setting the optional state will force addition/removal.\n         * State is here to keep the jQuery syntax\n         *\n         * @param {String} className\n         * @param {Boolean} [state]\n         */\n        toggleClass : function(className, state) {\n\n            if(typeof state === 'boolean') {\n                return state ? this.addClass(className) : this.removeClass(className);\n            }\n\n            if(this.hasClass(className)) {\n                return this.removeClass(className);\n            }\n            return this.addClass(className);\n        },\n        isset : function(){\n            return Element.issetElement(this.serial);\n        },\n        unset : function(){\n            return Element.unsetElement(this.serial);\n        }\n    });\n\n    var _containClass = function(allClassStr, className){\n        var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)', '');\n        return allClassStr && regex.test(allClassStr);\n    };\n\n    //helpers\n    Element.isA = function(qtiElement, qtiClass){\n        return (qtiElement instanceof Element && qtiElement.is(qtiClass));\n    };\n\n    Element.getElementBySerial = function(serial){\n        return _instances[serial];\n    };\n\n    Element.issetElement = function(serial){\n        return !!_instances[serial];\n    };\n\n    /**\n     * Unset a registered element from it's serial\n     * @param {String} serial - the element serial\n     * @returns {Boolean} true if unset\n     */\n    Element.unsetElement = function(serial){\n\n        var element = Element.getElementBySerial(serial);\n\n        if(element){\n\n            var composingElements = element.getComposingElements();\n            _.each(composingElements, function(elt){\n                delete _instances[elt.serial];\n            });\n            delete _instances[element.serial];\n\n            return true;\n        }\n        return false;\n    };\n\n    return Element;\n});\n\n\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n *\n */\n//@todo : move this to the ../helper directory\ndefine('taoQtiItem/qtiItem/core/Loader',['lodash', 'class', 'taoQtiItem/qtiItem/core/qtiClasses', 'taoQtiItem/qtiItem/core/Element'], function(_, Class, qtiClasses, Element){\n\n    var Loader = Class.extend({\n        init : function(item, classesLocation){\n\n            this.qti = {}; //loaded qti classes are store here\n            this.classesLocation = {};\n\n            this.item = item || null;//starts either from scratch or with an existing item object\n            this.setClassesLocation(classesLocation || qtiClasses);//load default location for qti classes model\n        },\n        setClassesLocation : function(qtiClasses){\n            _.extend(this.classesLocation, qtiClasses);\n            return this;\n        },\n        getRequiredClasses : function(data){\n            var ret = [];\n            for(var i in data){\n                if(i === 'qtiClass' && data[i] !== '_container' && i !== 'relatedItem'){//although a _container is a concrete class in TAO, it is not defined in QTI standard\n                    ret.push(data[i]);\n                }else if(typeof(data[i]) === 'object' && i !== 'responseRules'){    //responseRules should'nt be part of the parsing\n                    ret = _.union(ret, this.getRequiredClasses(data[i]));\n                }\n            }\n            return ret;\n        },\n        loadRequiredClasses : function(data, callback, reload){\n\n            var requiredClasses = this.getRequiredClasses(data, reload), required = [];\n\n            for(var i in requiredClasses){\n                var requiredClass = requiredClasses[i];\n                if(this.classesLocation[requiredClass]){\n                    required.push(this.classesLocation[requiredClass]);\n                }else{\n                    throw new Error('missing qti class location declaration : ' + requiredClass);\n                }\n            }\n\n            var _this = this;\n            require(required, function(){\n                _.each(arguments, function(QtiClass){\n                    _this.qti[QtiClass.prototype.qtiClass] = QtiClass;\n                });\n                callback.call(_this, _this.qti);\n            });\n        },\n        getLoadedClasses : function(){\n            return _.keys(this.qti);\n        },\n        loadItemData : function(data, callback){\n\n            var _this = this;\n            _this.loadRequiredClasses(data, function(Qti){\n                var i;\n                if(typeof(data) === 'object' && data.qtiClass === 'assessmentItem'){\n\n                    //unload an item from it's serial (in case of a reload)\n                    if(data.serial){\n                        Element.unsetElement(data.serial);\n                    }\n\n                    _this.item = new Qti.assessmentItem(data.serial, data.attributes || {});\n                    _this.loadContainer(_this.item.getBody(), data.body);\n\n                    for(i in data.outcomes){\n                        var outcome = _this.buildOutcome(data.outcomes[i]);\n                        if(outcome){\n                            _this.item.addOutcomeDeclaration(outcome);\n                        }\n                    }\n                    for(i in data.feedbacks){\n                        var feedback = _this.buildElement(data.feedbacks[i]);\n                        if(feedback){\n                            _this.item.addModalFeedback(feedback);\n                        }\n                    }\n                    for(i in data.stylesheets){\n                        var stylesheet = _this.buildElement(data.stylesheets[i]);\n                        if(stylesheet){\n                            _this.item.addStylesheet(stylesheet);\n                        }\n                    }\n\n                    //important : build responses after all modal feedbacks and outcomes has been loaded, because the simple feedback rules need to reference them\n                    for(i in data.responses){\n                        var response = _this.buildResponse(data.responses[i]);\n                        if(response){\n                            _this.item.addResponseDeclaration(response);\n\n                            var feedbackRules = data.responses[i].feedbackRules;\n                            if(feedbackRules){\n                                _.forIn(feedbackRules, function(fbData, serial){\n                                    response.feedbackRules[serial] = _this.buildSimpleFeedbackRule(fbData);\n                                });\n                            }\n                        }\n                    }\n\n                    if(data.responseProcessing){\n                        _this.item.setResponseProcessing(_this.buildResponseProcessing(data.responseProcessing));\n                    }\n                    _this.item.setNamespaces(data.namespaces);\n                }\n\n                if(typeof(callback) === 'function'){\n                    callback.call(_this, _this.item);\n                }\n            });\n        },\n        loadAndBuildElement : function(data, callback){\n\n            var _this = this;\n\n            _this.loadRequiredClasses(data, function(Qti){\n\n                var element = _this.buildElement(data);\n\n                if(typeof(callback) === 'function'){\n                    callback.call(_this, element);\n                }\n            });\n        },\n        loadElement : function(element, data, callback){\n\n            var _this = this;\n            this.loadRequiredClasses(data, function(){\n                _this.loadElementData(element, data);\n                if(typeof(callback) === 'function'){\n                    callback.call(_this, element);\n                }\n            });\n        },\n        /**\n         * Load ALL given elements into existing loaded item\n         *\n         * @todo to be renamed to loadItemElements\n         * @param {object} data\n         * @param {function} callback\n         * @returns {undefined}\n         */\n        loadElements : function(data, callback){\n\n            var _this = this;\n\n            if(_this.item){\n\n                this.loadRequiredClasses(data, function(){\n\n                    var allElements = _this.item.getComposingElements();\n\n                    for(var i in data){\n                        var elementData = data[i];\n                        if(elementData && elementData.qtiClass && elementData.serial){\n                            //find and update element\n                            if(allElements[elementData.serial]){\n                                _this.loadElementData(allElements[elementData.serial], elementData);\n                            }\n                        }\n                    }\n\n                    if(typeof(callback) === 'function'){\n                        callback.call(_this, _this.item);\n                    }\n                });\n            }else{\n                throw 'QtiLoader : cannot load elements in empty item';\n            }\n\n        },\n        buildResponse : function(data){\n\n            var response = this.buildElement(data);\n\n            response.template = data.howMatch || null;\n            response.defaultValue = data.defaultValue || null;\n            response.correctResponse = data.correctResponses || null;\n\n            if(_.size(data.mapping)){\n                response.mapEntries = data.mapping;\n            }else if(_.size(data.areaMapping)){\n                response.mapEntries = data.areaMapping;\n            }else{\n                response.mapEntries = {};\n            }\n\n            response.mappingAttributes = data.mappingAttributes || {};\n\n            return response;\n        },\n        buildSimpleFeedbackRule : function(data){\n\n            var feedbackRule = this.buildElement(data);\n\n            if(data.condition){\n                feedbackRule.condition = data.condition;\n            }\n            if(data.comparedValue){\n                feedbackRule.comparedValue = data.comparedValue;\n            }\n\n            feedbackRule.comparedOutcome = this.item.responses[data.comparedOutcome] || null;\n            feedbackRule.feedbackOutcome = this.item.outcomes[data.feedbackOutcome] || null;\n            feedbackRule.feedbackThen = this.item.modalFeedbacks[data.feedbackThen] || null;\n            feedbackRule.feedbackElse = this.item.modalFeedbacks[data.feedbackElse] || null;\n\n            return feedbackRule;\n        },\n        buildOutcome : function(data){\n            var outcome = this.buildElement(data);\n            outcome.defaultValue = data.defaultValue || null;\n            return outcome;\n        },\n        buildResponseProcessing : function(data){\n            var rp = this.buildElement(data);\n            if(data && data.processingType){\n                if(data.processingType === 'custom'){\n                    rp.xml = data.data;\n                    rp.processingType = 'custom';\n                }else{\n                    rp.processingType = 'templateDriven';\n                }\n            }\n            return rp;\n        },\n        loadContainer : function(bodyObject, bodyData){\n            if(!Element.isA(bodyObject, '_container')){\n                throw 'bodyObject must be a QTI Container';\n            }\n\n            if(bodyData && typeof bodyData.body === 'string' && (typeof bodyData.elements === 'array' || typeof bodyData.elements === 'object')){\n                for(var serial in bodyData.elements){\n                    var eltData = bodyData.elements[serial];\n                    //check if class is loaded:\n                    var element = this.buildElement(eltData);\n                    if(element){\n                        bodyObject.setElement(element, bodyData.body);\n                    }\n                }\n                bodyObject.body(bodyData.body);\n            }else{\n                throw 'wrong bodydata format';\n            }\n        },\n        buildElement : function(elementData){\n            var elt = null;\n            if(elementData && elementData.qtiClass && elementData.serial){\n                var className = elementData.qtiClass;\n                if(this.qti[className]){\n                    elt = new this.qti[className](elementData.serial);\n                    this.loadElementData(elt, elementData);\n                }else{\n                    throw 'the qti element class does not exist: ' + className;\n                }\n            }else{\n                throw 'wrong elementData format';\n            }\n            return elt;\n        },\n        loadElementData : function(element, data){\n\n            //merge attributes when loading element data\n            var attributes = _.defaults(data.attributes || {}, element.attributes || {});\n            element.setAttributes(attributes);\n\n            if(element.body && data.body){\n                if(element.bdy){\n                    this.loadContainer(element.getBody(), data.body);\n                }\n            }\n\n            if(element.object && data.object){\n                if(element.object){\n                    this.loadObjectData(element.object, data.object);\n                }\n            }\n\n            if(Element.isA(element, 'interaction')){\n                this.loadInteractionData(element, data);\n            }else if(Element.isA(element, 'choice')){\n                this.loadChoiceData(element, data);\n            }else if(Element.isA(element, 'math')){\n                this.loadMathData(element, data);\n            }else if(Element.isA(element, 'infoControl')){\n                this.loadPicData(element, data);\n            }\n\n            return element;\n        },\n        loadInteractionData : function(interaction, data){\n            if(Element.isA(interaction, 'blockInteraction')){\n                if(data.prompt){\n                    this.loadContainer(interaction.prompt.getBody(), data.prompt);\n                }\n            }\n\n            this.buildInteractionChoices(interaction, data);\n\n            if(Element.isA(interaction, 'customInteraction')){\n                this.loadPciData(interaction, data);\n            }\n        },\n        buildInteractionChoices : function(interaction, data){\n\n            //note: Qti.ContainerInteraction (Qti.GapMatchInteraction and Qti.HottextInteraction) has already been parsed by builtElement(interacionData);\n            if(data.choices){\n                if(Element.isA(interaction, 'matchInteraction')){\n                    for(var set = 0; set < 2; set++){\n                        if(!data.choices[set]){\n                            throw 'missing match set #' + set;\n                        }\n                        var matchSet = data.choices[set];\n                        for(var serial in matchSet){\n                            var choice = this.buildElement(matchSet[serial]);\n                            if(choice){\n                                interaction.addChoice(choice, set);\n                            }\n                        }\n                    }\n                }else{\n                    for(var serial in data.choices){\n                        var choice = this.buildElement(data.choices[serial]);\n                        if(choice){\n                            interaction.addChoice(choice);\n                        }\n                    }\n                }\n\n                if(Element.isA(interaction, 'graphicGapMatchInteraction')){\n                    if(data.gapImgs){\n                        for(var serial in data.gapImgs){\n                            var gapImg = this.buildElement(data.gapImgs[serial]);\n                            if(gapImg){\n                                interaction.addGapImg(gapImg);\n                            }\n                        }\n                    }\n                }\n\n            }\n\n        },\n        loadChoiceData : function(choice, data){\n            if(Element.isA(choice, 'textVariableChoice')){\n                choice.val(data.text);\n            }else if(Element.isA(choice, 'gapImg')){\n                //has already been taken care of in buildElement()\n            }else if(Element.isA(choice, 'containerChoice')){\n                //has already been taken care of in buildElement()\n            }\n        },\n        loadObjectData : function(object, data){\n            object.setAttributes(data.attributes);\n            //@todo: manage object like a container\n            if(data._alt){\n                if(data._alt.qtiClass === 'object'){\n                    object._alt = Loader.buildElement(data._alt);\n                }else{\n                    object._alt = data._alt;\n                }\n            }\n        },\n        loadMathData : function(math, data){\n            math.ns = data.ns || {};\n            math.setMathML(data.mathML || '');\n            _.forIn(data.annotations || {}, function(value, encoding){\n                math.setAnnotation(encoding, value);\n            });\n        },\n        loadPciData : function(pci, data){\n            loadPortableCustomElementData(pci, data);\n        },\n        loadPicData : function(pic, data){\n            loadPortableCustomElementData(pic, data);\n        }\n    });\n\n    function loadPortableCustomElementData(portableElement, data){\n        portableElement.typeIdentifier = data.typeIdentifier;\n        portableElement.markup = data.markup;\n        portableElement.entryPoint = data.entryPoint;\n        portableElement.properties = data.properties;\n        portableElement.libraries = data.libraries;\n    }\n\n    return Loader;\n});\n\n","/**\n * Common helper functions\n */\ndefine('taoQtiItem/qtiItem/helper/interactionHelper',['lodash', 'taoQtiItem/qtiItem/core/Element'], function(_, Element){\n    return {\n        convertChoices : function(choices, outputType){\n\n            var ret = [], _this = this;\n\n            _.each(choices, function(c){\n                if(Element.isA(c, 'choice')){\n                    switch(outputType){\n                        case 'serial':\n                            ret.push(c.getSerial());\n                            break;\n                        case 'identifier':\n                            ret.push(c.id());\n                            break;\n                        default:\n                            ret.push(c);\n                    }\n\n                }else if(_.isArray(c)){\n                    ret.push(_this.convertChoices(c, outputType));\n                }\n            });\n\n            return ret;\n        },\n        findChoices : function(interaction, choices, inputType){\n\n            var ret = [], _this = this;\n\n            _.each(choices, function(c){\n                var choice;\n                if(_.isString(c)){\n                    if(inputType === 'serial'){\n                        choice = interaction.getChoice(c);\n                        if(choice){\n                            ret.push(choice);\n                        }\n                    }else if(inputType === 'identifier'){\n                        choice = interaction.getChoiceByIdentifier(c);\n                        if(choice){\n                            ret.push(choice);\n                        }\n                    }else{\n                        ret.push(c);\n                    }\n                }else if(_.isArray(c)){\n                    ret.push(_this.findChoices(interaction, c, inputType));\n                }else{\n                    ret.push(c);\n                }\n            });\n\n            return ret;\n        },\n        shuffleChoices : function(choices){\n            var r = [], //returned array\n                f = {}, //fixed choices array\n                j = 0;\n\n            for(var i in choices){\n                if(Element.isA(choices[i], 'choice')){\n                    var choice = choices[i];\n                    if(choice.attr('fixed')){\n                        f[j] = choice;\n                    }\n                    r.push(choice);\n                    j++;\n                }else{\n                    throw 'invalid element in array: is not a qti choice';\n                }\n            }\n\n            for(var n = 0; n < r.length - 1; n++){\n                if(f[n]){\n                    continue;\n                }\n                var k = -1;\n                do{\n                    k = n + Math.floor(Math.random() * (r.length - n));\n                }while(f[k]);\n                var tmp = r[k];\n                r[k] = r[n];\n                r[n] = tmp;\n            }\n\n            return r;\n        },\n        serialToIdentifier : function(interaction, choiceSerial){\n            var choice = interaction.getChoice(choiceSerial);\n            if(choice){\n                return choice.id();\n            }else{\n                return '';\n            }\n        }\n    }\n});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\n *\n */\n\n/**\n * A factory to create a QTI renderer.\n *\n * @author Sam Sipasseuth <sam@taotesting.com>\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiItem/qtiRunner/core/Renderer',[\n    'lodash',\n    'jquery',\n    'handlebars',\n    'core/promise',\n    'taoQtiItem/qtiItem/core/Element',\n    'taoQtiItem/qtiItem/helper/interactionHelper',\n    'ui/themeLoader'\n], function(_, $, Handlebars, Promise, Element, interactionHelper, themeLoader){\n    'use strict';\n\n    var _isValidRenderer = function(renderer){\n\n        var valid = true;\n\n        if(typeof (renderer) !== 'object'){\n            return false;\n        }\n\n        var classCorrect = false;\n        if(renderer.qtiClass){\n            if(_.indexOf(_renderableClasses, renderer.qtiClass) >= 0){\n                classCorrect = true;\n            }else{\n                var pos = renderer.qtiClass.indexOf('.');\n                if(pos > 0){\n                    var qtiClass = renderer.qtiClass.slice(0, pos);\n                    var subClass = renderer.qtiClass.slice(pos + 1);\n                    if(_renderableSubclasses[qtiClass] && _.indexOf(_renderableSubclasses[qtiClass], subClass) >= 0){\n                        classCorrect = true;\n                    }\n                }\n            }\n        }\n        if(!classCorrect){\n            valid = false;\n            throw new Error('invalid qti class name in renderer declaration : ' + renderer.qtiClass);\n        }\n\n        if(!renderer.template){\n            valid = false;\n            throw new Error('missing template in renderer declaration : ' + renderer.qtiClass);\n        }\n\n        return valid;\n    };\n\n    var _renderableClasses = [\n        '_container',\n        'assessmentItem',\n        'stylesheet',\n        'responseDeclaration',\n        'outcomeDeclaration',\n        'responseProcessing',\n        '_simpleFeedbackRule',\n        'img',\n        'math',\n        'object',\n        'modalFeedback',\n        'rubricBlock',\n        'associateInteraction',\n        'choiceInteraction',\n        'extendedTextInteraction',\n        'gapMatchInteraction',\n        'graphicAssociateInteraction',\n        'graphicGapMatchInteraction',\n        'graphicOrderInteraction',\n        'hotspotInteraction',\n        'hottextInteraction',\n        'inlineChoiceInteraction',\n        'matchInteraction',\n        'mediaInteraction',\n        'orderInteraction',\n        'selectPointInteraction',\n        'sliderInteraction',\n        'textEntryInteraction',\n        'uploadInteraction',\n        'endAttemptInteraction',\n        'customInteraction',\n        'prompt',\n        'associableHotspot',\n        'gap',\n        'gapImg',\n        'gapText',\n        'hotspotChoice',\n        'hottext',\n        'inlineChoice',\n        'simpleAssociableChoice',\n        'simpleChoice',\n        'infoControl',\n        'include'\n    ];\n\n    /**\n     * The list of qti element dependencies. It is used internally to load dependent qti classes\n     */\n    var _dependencies = {\n        assessmentItem : ['stylesheet', '_container', 'prompt', 'modalFeedback'],\n        rubricBlock : ['_container'],\n        associateInteraction : ['simpleAssociableChoice'],\n        choiceInteraction : ['simpleChoice'],\n        gapMatchInteraction : ['gap', 'gapText'],\n        graphicAssociateInteraction : ['associableHotspot'],\n        graphicGapMatchInteraction : ['associableHotspot', 'gapImg'],\n        graphicOrderInteraction : ['hotspotChoice'],\n        hotspotInteraction : ['hotspotChoice'],\n        hottextInteraction : ['hottext'],\n        inlineChoiceInteraction : ['inlineChoice'],\n        matchInteraction : ['simpleAssociableChoice'],\n        orderInteraction : ['simpleChoice']\n    };\n\n    /**\n     * The list of supported qti subclasses.\n     */\n    var _renderableSubclasses = {\n        'simpleAssociableChoice' : ['associateInteraction', 'matchInteraction'],\n        'simpleChoice' : ['choiceInteraction', 'orderInteraction']\n    };\n\n    /**\n     * List of the default properties for the item\n     */\n    var _defaults = {\n        shuffleChoices : true\n    };\n\n    /**\n     * Get the location of the document, useful to define a baseUrl for the required context\n     * @returns {String}\n     */\n    function getDocumentBaseUrl(){\n        return window.location.protocol + '//' + window.location.host + window.location.pathname.replace(/([^\\/]*)$/, '');\n    }\n\n    /**\n     * The built Renderer class\n     * @constructor\n     * @param {Object} [options] - the renderer options\n     * @param {AssetManager} [options.assetManager] - The renderer needs an AssetManager to resolve URLs (see {@link taoItems/assets/manager})\n     * @param {Boolean} [options.shuffleChoices = true] - Does the renderer take care of the shuffling\n     * @param {Object} [options.decorators] - to set up rendering decorator\n     * @param {preRenderDecorator} [options.decorators.before] - to set up a pre decorator\n     * @param {postRenderDecorator} [options.decorators.after] - to set up a post decorator\n     */\n    var Renderer = function(options){\n\n        /**\n         * Store the registered renderer location\n         */\n        var _locations = {};\n\n        /**\n         * Store loaded renderers\n         */\n        var _renderers = {};\n\n        options = _.defaults(options || {}, _defaults);\n\n        this.isRenderer = true;\n\n        this.name = '';\n\n        //store shuffled choice here\n        this.shuffledChoices = [];\n\n        /**\n         * Get the actual renderer of the give qti class or subclass:\n         * e.g. simplceChoice, simpleChoice.choiceInteraction, simpleChoice.orderInteraction\n         */\n        var _getClassRenderer = function(qtiClass){\n            var ret = null;\n            if(_renderers[qtiClass]){\n                ret = _renderers[qtiClass];\n            }else{\n                var pos = qtiClass.indexOf('.');\n                if(pos > 0){\n                    qtiClass = qtiClass.slice(0, pos);\n                    if(_renderers[qtiClass]){\n                        ret = _renderers[qtiClass];\n                    }\n                }\n            }\n            return ret;\n        };\n\n        /**\n         * Set the renderer options\n         * @param {String} key - the name of the option\n         * @param {*} value - the option vallue\n         * @returns {Renderer} for chaining\n         */\n        this.setOption = function(key, value){\n            if(typeof (key) === 'string'){\n                options[key] = value;\n            }\n            return this;\n        };\n\n        /**\n         * Set the renderer options\n         * @param {Object} opts - the options\n         * @returns {Renderer} for chaining\n         */\n        this.setOptions = function(opts){\n            options = _.extend(options, opts);\n            return this;\n        };\n\n        /**\n         * Get the renderer option\n         * @param {String} key - the name of the option\n         * @returns {*|null} the option vallue\n         */\n        this.getOption = function(key){\n            if(typeof (key) === 'string' && options[key]){\n                return options[key];\n            }\n            return null;\n        };\n\n        /**\n         * Get the bound assetManager\n         * @returns {AssetManager} the assetManager\n         */\n        this.getAssetManager = function getAssetManager(){\n            return options.assetManager;\n        };\n\n        /**\n         * Get the bound theme loader\n         * @returns {Object} the themeLoader\n         */\n        this.getThemeLoader = function getThemeLoader(){\n            return this.themeLoader;\n        };\n\n\n        /**\n         * Renders the template\n         * @param {Object} element - the QTI model element\n         * @param {Object} data - the data to give to the template\n         * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n         * @returns {String} the template results\n         * @throws {Error} if the renderer is not set or has no template bound\n         */\n        this.renderTpl = function(element, data, qtiSubclass){\n\n            var res;\n            var ret        = '';\n            var tplFound   = false;\n            var qtiClass   = qtiSubclass || element.qtiClass;\n            var renderer   = _getClassRenderer(qtiClass);\n            var decorators = this.getOption('decorators');\n\n            if(!renderer || !_.isFunction(renderer.template)){\n                throw new Error('no renderer template loaded under the class name : ' + qtiClass);\n            }\n\n            //pre rendering decoration\n            if(_.isObject(decorators) && _.isFunction(decorators.before)){\n\n                /**\n                 * @callback preRenderDecoractor\n                 * @param {Object} element - the QTI model element\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n                 * @returns {String} the decorator result\n                 */\n                res = decorators.before(element, qtiSubclass);\n                if(_.isString(res)){\n                    ret += res;\n                }\n            }\n\n            //render the template\n            ret += renderer.template(data);\n\n\n            //post rendering decoration\n            if(_.isObject(decorators) && _.isFunction(decorators.after)){\n\n                /**\n                 * @callback postRenderDecoractor\n                 * @param {Object} element - the QTI model element\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\n                 * @returns {String} the decorator result\n                 */\n                res = decorators.after(element, qtiSubclass);\n                if(_.isString(res)){\n                    ret += res;\n                }\n            }\n            return ret;\n        };\n\n        this.getData = function(element, data, qtiSubclass){\n\n            var ret = data,\n                qtiClass = qtiSubclass || element.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.getData) === 'function'){\n                    ret = renderer.getData.call(this, element, data);\n                }\n            }\n\n            return ret;\n        };\n\n        this.renderDirect = function(tpl, data){\n            return Handlebars.compile(tpl)(data);\n        };\n\n        this.getContainer = function(qtiElement, $scope, qtiSubclass){\n\n            var ret = null,\n                qtiClass = qtiSubclass || qtiElement.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                ret = renderer.getContainer(qtiElement, $scope);\n            }else{\n                throw 'no renderer found for the class : ' + qtiElement.qtiClass;\n            }\n            return ret;\n        };\n\n        this.postRender = function(qtiElement, data, qtiSubclass){\n\n            var qtiClass = qtiSubclass || qtiElement.qtiClass;\n            var renderer = _getClassRenderer(qtiClass);\n\n            if(renderer && typeof (renderer.render) === 'function') {\n                return renderer.render.call(this, qtiElement, data);\n            }\n        };\n\n        this.setResponse = function(qtiInteraction, response, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.setResponse) === 'function'){\n                    ret = renderer.setResponse.call(this, qtiInteraction, response);\n                    var $container = renderer.getContainer.call(this, qtiInteraction);\n                    if($container instanceof $ && $container.length){\n                        $container.trigger('responseSet', [qtiInteraction, response]);\n                    }\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.getResponse = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.getResponse) === 'function'){\n                    ret = renderer.getResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.resetResponse = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(typeof (renderer.resetResponse) === 'function'){\n                    ret = renderer.resetResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        /**\n         * Retrieve the state of the interaction.\n         * If the renderer has no state management, it falls back to the response management.\n         *\n         * @param {Object} qtiInteraction - the interaction\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\n         * @returns {Object} the interaction's state\n         *\n         * @throws {Error} if no renderer is registered\n         */\n        this.getState = function(qtiInteraction, qtiSubclass){\n\n            var ret = false;\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\n            var renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.getState)){\n                    ret = renderer.getState.call(this, qtiInteraction);\n                } else {\n                    ret = renderer.getResponse.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        /**\n         * Retrieve the state of the interaction.\n         * If the renderer has no state management, it falls back to the response management.\n         *\n         * @param {Object} qtiInteraction - the interaction\n         * @param {Object} state - the interaction's state\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\n         *\n         * @throws {Error} if no renderer is found\n         */\n        this.setState =  function(qtiInteraction, state, qtiSubclass){\n\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\n            var renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.setState)){\n                    renderer.setState.call(this, qtiInteraction, state);\n                } else {\n                    renderer.resetResponse.call(this, qtiInteraction);\n                    renderer.setResponse.call(this, qtiInteraction, state);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n        };\n\n        /**\n         * Calls the renderer destroy.\n         * Ask the renderer to run destroy if exists.\n         *\n         * @throws {Error} if no renderer is found\n         */\n        this.destroy = function(qtiInteraction, qtiSubclass){\n\n            var ret = false,\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\n                renderer = _getClassRenderer(qtiClass);\n\n            if(renderer){\n                if(_.isFunction(renderer.destroy)){\n                    ret = renderer.destroy.call(this, qtiInteraction);\n                }\n            }else{\n                throw 'no renderer registered under the name : ' + qtiClass;\n            }\n            return ret;\n        };\n\n        this.getLoadedRenderers = function(){\n            return _renderers;\n        };\n\n        this.register = function(renderersLocations){\n            _.extend(_locations, renderersLocations);\n        };\n\n        this.load = function(callback, requiredClasses){\n           var self = this;\n            var required = [];\n\n            if(options.themes){\n\n                //resolve themes paths\n                options.themes.base = this.resolveUrl(options.themes.base);\n                _.forEach(options.themes.available, function(theme, index){\n                    options.themes.available[index].path = self.resolveUrl(theme.path);\n                });\n                this.themeLoader = themeLoader(options.themes).load();\n            }\n\n            if(requiredClasses){\n                if(_.isArray(requiredClasses)){\n\n                    //exclude abstract classes\n                    requiredClasses = _.intersection(requiredClasses, _renderableClasses);\n\n                    //add dependencies\n                    _.each(requiredClasses, function(reqClass){\n                        var deps = _dependencies[reqClass];\n                        if(deps){\n                            requiredClasses = _.union(requiredClasses, deps);\n                        }\n                    });\n\n                    _.forEach(requiredClasses, function(qtiClass){\n\n                        if(_renderableSubclasses[qtiClass]){\n                            var requiredSubClasses = _.intersection(requiredClasses, _renderableSubclasses[qtiClass]);\n                            _.each(requiredSubClasses, function(subclass){\n                                if(_locations[qtiClass + '.' + subclass]){\n                                    required.push(_locations[qtiClass + '.' + subclass]);\n                                }else if(_locations[qtiClass]){\n                                    required.push(_locations[qtiClass]);\n                                }else{\n                                    throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass + ', subclass: ' + subclass);\n                                }\n                            });\n                        } else {\n                            if(_locations[qtiClass] === false){\n                                _renderers[qtiClass] = false;//mark this class as not renderable\n                            }else if(_locations[qtiClass]){\n                                required.push(_locations[qtiClass]);\n                            }else{\n                                throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass);\n                            }\n                        }\n                    });\n                } else {\n                    throw new Error('invalid argument type: expected array for arg \"requireClasses\"');\n                }\n\n            }else{\n                required = _.values(_locations);\n            }\n\n            var _this = this;\n            require(required, function(){\n\n                _.each(arguments, function(clazz){\n                    if(_isValidRenderer(clazz)){\n                        _renderers[clazz.qtiClass] = clazz;\n                    }\n                });\n\n                if(typeof (callback) === 'function'){\n                    callback.call(_this, _renderers);\n                }\n            });\n\n            return this;\n        };\n\n        /**\n         * Unload the renderer\n         */\n        this.unload = function unload(){\n            if(this.themeLoader){\n                themeLoader(options.themes).unload();\n            }\n            return this;\n        };\n\n        /**\n         * Define the shuffling manually\n         *\n         * @param {Object} interaction - the interaction\n         * @param {Array} choices - the shuffled choices\n         * @param {String} identificationType -\n         */\n        this.setShuffledChoices = function(interaction, choices, identificationType){\n            if(Element.isA(interaction, 'interaction')){\n                this.shuffledChoices[interaction.getSerial()] = _.pluck(interactionHelper.findChoices(interaction, choices, identificationType), 'serial');\n            }\n        };\n\n        /**\n         * Get the choices shuffled for this interaction.\n         *\n         * @param {Object} interaction - the interaction\n         * @param {Boolean} reshuffle - by default choices are shuffled only once and store, but if true you can force shuffling again\n         * @param {String} returnedType - the choice type\n         * @returns {Array} the choices\n         */\n        this.getShuffledChoices = function(interaction, reshuffle, returnedType){\n            var choices = [];\n            var shuffled = [];\n            var serial, i;\n\n            if(Element.isA(interaction, 'interaction')){\n                serial = interaction.getSerial();\n\n                //1st time, we shuffle (or asked to force shuffling)\n                if(!this.shuffledChoices[serial] || reshuffle){\n                    if(Element.isA(interaction, 'matchInteraction')){\n                        this.shuffledChoices[serial] = [];\n                        for(i = 0; i < 2; i++){\n                            choices[i] = interactionHelper.shuffleChoices(interaction.getChoices(i));\n                            this.shuffledChoices[serial][i] = _.pluck(choices[i], 'serial');\n                        }\n                    } else {\n                        choices = interactionHelper.shuffleChoices(interaction.getChoices());\n                        this.shuffledChoices[serial] = _.pluck(choices, 'serial');\n                    }\n\n                //otherwise get the choices from the serials\n                } else {\n                    if(Element.isA(interaction, 'matchInteraction')){\n                        _.forEach(choices, function(choice, index){\n                            if(index < 2){\n                                _.forEach(this.shuffledChoices[serial][i], function(choiceSerial){\n                                    choice.push(interaction.getChoice(choiceSerial));\n                                });\n                            }\n                        });\n                    } else {\n                        _.forEach(this.shuffledChoices[serial], function(choiceSerial){\n                            choices.push(interaction.getChoice(choiceSerial));\n                        });\n                    }\n                }\n\n                //do some type convertion\n                if(returnedType === 'serial' || returnedType === 'identifier'){\n                    return interactionHelper.convertChoices(choices, returnedType);\n                }\n\n                //pass value only, not ref\n                return _.clone(choices);\n            }\n\n            return [];\n        };\n\n        this.getRenderers = function(){\n            return _renderers;\n        };\n\n        this.getLocations = function(){\n            return _locations;\n        };\n\n        /**\n         * Resolve URLs using the defined assetManager's strategies\n         * @param {String} url - the URL to resolve\n         * @returns {String} the resolved URL\n         */\n        this.resolveUrl = function resolveUrl(url){\n            if(!options.assetManager){\n                return url;\n            }\n            if(typeof url === 'string' && url.length > 0){\n                return options.assetManager.resolve(url);\n            }\n        };\n\n        /**\n         * @deprecated in favor of resolveUrl\n         */\n        this.getAbsoluteUrl = function(relUrl){\n\n            //let until method is removed\n            console.warn('DEPRECATED used getAbsoluteUrl with ', arguments);\n\n            //allow relative url output only if explicitely said so\n            if(this.getOption('userRelativeUrl')){\n                return relUrl.replace(/^\\.?\\//, '');\n            }\n\n            if(/^http(s)?:\\/\\//i.test(relUrl) || /^data:[^\\/]+\\/[^;]+(;charset=[\\w]+)?;base64,/.test(relUrl)){\n                //already absolute or base64 encoded\n                return relUrl;\n            }else{\n\n                var absUrl = '';\n                var runtimeLocations = this.getOption('runtimeLocations');\n\n                if(runtimeLocations && _.size(runtimeLocations)){\n                    _.forIn(runtimeLocations, function(runtimeLocation, typeIdentifier){\n                        if(relUrl.indexOf(typeIdentifier) === 0){\n                            absUrl = relUrl.replace(typeIdentifier, runtimeLocation);\n                            return false;//break\n                        }\n                    });\n                }\n\n                if(absUrl){\n                    return absUrl;\n                }else{\n                    var baseUrl = this.getOption('baseUrl') || getDocumentBaseUrl();\n                    return baseUrl + relUrl;\n                }\n\n            }\n        };\n    };\n\n    /**\n     * Expose the renderer's factory\n     * @exports taoQtiItem/qtiRunner/core/Renderer\n     */\n    return {\n\n        /**\n         * Creates a new Renderer by extending the Renderer's prototype\n         * @param {Object} renderersLocations -\n         * @param {String} [name] - the new renderer name\n         * @param {Object} [defaultOptions] - the renderer options\n         */\n        build : function(renderersLocations, name, defaultOptions){\n            var NewRenderer = function(){\n                var options = _.isPlainObject(arguments[0]) ? arguments[0] : {};\n\n                Renderer.apply(this);\n\n                this.register(renderersLocations);\n                this.name = name || '';\n                this.setOptions(_.defaults(options, defaultOptions || {}));\n            };\n            NewRenderer.prototype = Renderer.prototype;\n            return NewRenderer;\n        }\n    };\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n */\n\n/**\n * The asset manager proposes you to resolve your asset URLs for you!\n * You need to add the resolution strategies, it will then evaluate each strategy until the right one is found\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoItems/assets/manager',[\n    'lodash',\n    'util/url'\n], function(_, urlUtil){\n    'use strict';\n\n    /**\n     * @typedef AssetStrategy Defines a way to resolve an asset path\n     * @property {String} name - the strategy name\n     * @property {assetStrategyHandle} handle - how to resolve the strategy.\n     */\n\n    /**\n     * @callback assetStrategyHandle\n     * @param {String|Object} url - the URL to resolved. If parseUrl, it's an object that contains host, port, search, queryString, etc.\n     * @param {Object} data - the context data\n     * @returns {String?} falsy if not resolved otherwise the resolved URL\n     */\n\n\n    /**\n     * The assetManagerFactory create a new assetManager with the given resolution stratgies and a data context.\n     *\n     * @example\n     *   //define AssetStrategies with a name and a handle method\n     *   var strategies = [{\n     *       name : 'external',\n     *       handle : function(url, data){\n     *           if(/^http/.test(url)){\n     *               return path;\n     *           }\n     *       }\n     *   }, {\n     *       name : 'relative',\n     *       handle : function(url, data){\n     *           if(/^((\\.\\/)|(\\w\\/))/){\n     *               return data.baseUrl + '/' + url ;\n     *           }\n     *       }\n     *   }]);\n     *\n     *   var assetManager = assetManagerFactory(strategies, { baseUrl : 'http://t.oa/public/assets/' });\n     *   assetManager.resolve('http://foo/bar.png'); //will resolved using external\n     *   assetManager.resolve('bar.png'); //will resolved using relative strategy\n     *\n     * @param {AssetStrategy[]} strategies - the strategies\n     * @param {Object} data - the context data\n     * @param {Object} [options] - the manager options\n     * @param {Boolean} [options.parseUrl = true] - If the URL to give to the stragies should be parsed or given as it is.\n     * @param {Boolean} [options.cache] - resolve the same URL only once and store the result in memory.\n     *\n     * @exports taoItems/assets/manager\n     * @namespace assetManagerFactory\n     */\n    var assetManagerFactory = function assetManagerFactory(strategies, data, options) {\n\n        var cache  = {};\n\n        strategies = _.isArray(strategies) ? strategies : [strategies];\n        data       = data || {};\n        options    = _.defaults(options || {}, {\n            parseUrl : true\n        });\n\n        /**\n         * A brand new asset manager is created by the factory\n         */\n        var assetManager = {\n\n            /**\n             * The stack of strategies that would be used to resolve the asset path\n             * @type {AssetStrategy[]}\n             */\n            _strategies : [],\n\n            /**\n             * Add an asset resolution strategy.\n             * The strategies will be evaluated in the order they've been added.\n             * @param {AssetStrategy} strategy - the strategy to add\n             * @throws {TypeError} if the strategy isn't defined correctly\n             */\n            addStrategy : function addStrategy (strategy){\n\n                if(!_.isPlainObject(strategy) || !_.isFunction(strategy.handle) || !_.isString(strategy.name)){\n                    throw new TypeError('An asset resolution strategy is an object with a handle method and a name');\n                }\n\n                this._strategies.push(strategy);\n            },\n\n            /**\n             * Change the strategies\n             * @param {AssetStrategy[]} strategies - the strategies\n             * @throws {TypeError} if the strategy isn't defined correctly\n             */\n            setStrategies : function setStrategies(newStrategies){\n                var self = this;\n\n                this._strategies = [];\n\n                //assign the strategies to the assetManager\n                _.forEach(newStrategies, function(strategy){\n\n                    //if it's an object we add it directly\n                    if(_.isPlainObject(strategy)){\n                        assetManager.addStrategy(strategy);\n\n                    //if it's a function, we create the strategy with a generated name\n                    } else if(_.isFunction(strategy)){\n                        self.addStrategy({\n                            name   : 'strategy_' + (self._strategies.length + 1),\n                            handle : strategy\n                        });\n                    }\n                });\n            },\n\n            /**\n             * Set context data\n             * @param {String|Object} [key] - the key of the data to set or the data values if it's an object\n             * @param {*} [value] - the value to set if a key is given\n             */\n            setData : function setData(key, value){\n                if(_.isString(key) && typeof value !== 'undefined'){\n                    data[key] = value;\n                } else if(_.isPlainObject(key)){\n                    data = key;\n                }\n            },\n\n            /**\n             * Get context data\n             * @param {String} [key] - if we want the value of a particuar key\n             * @returns {Object|*} all the data or the proprety value if key is given\n             */\n            getData : function getData(key){\n                if(_.isString(key)){\n                    return data[key];\n                }\n                return data;\n            },\n\n            /**\n             * Resolve the given URL against the strategies\n             * @param {String} url - the URL to resolve\n             * @returns {String?} the resolved URL or nothing\n             */\n            resolve : function resolve(url){\n                var resolved;\n                var inputUrl;\n\n                //if caching try to load the value from the cache\n                if(options.cache && cache.hasOwnProperty(url)){\n                    return cache[url];\n                }\n\n                //parse the url ?\n                inputUrl = options.parseUrl ? urlUtil.parse(url) : url;\n\n                //call strategies handlers, in their order until once returns somethin\n                _.forEach(this._strategies, function(strategy){\n                    var result = strategy.handle(inputUrl, data);\n                    if(result){\n                        resolved = result;\n                        return false;\n                    }\n                });\n\n                resolved = resolved || '';\n\n                if(options.cache){\n                    cache[url] = resolved;\n                }\n\n                return resolved;\n            },\n\n            /**\n             * Resolve the given URL against the strategy identified by the given name\n             * @param {String} name - the strategy name\n             * @param {String} url - the URL to resolve\n             * @returns {String?} the resolved URL or nothing\n             */\n            resolveBy : function resolveBy(name, url){\n                var inputUrl;\n                var resolved = '';\n                var strategy = _.find(this._strategies, {name : name});\n                if(strategy){\n                    //parse the url ?\n                    inputUrl = options.parseUrl ? urlUtil.parse(url) : url;\n                    resolved = strategy.handle(inputUrl, data);\n                }\n                return resolved;\n            },\n\n            /**\n             * When the cache is used, it could be useful to clear the cache\n             */\n            clearCache : function clearCache(){\n                if(options.cache){\n                    cache = {};\n                }\n            }\n        };\n\n        assetManager.setStrategies(strategies);\n\n        return assetManager;\n    };\n\n    return assetManagerFactory;\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n */\n\n/**\n * Provides common strategies to resolved assets\n * that may be used by any type of items.\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoItems/assets/strategies',[\n    'util/url'\n], function(urlUtil){\n    'use strict';\n\n    /**\n     * Unrelated strategies accessible by there name.\n     * Remember to not use the whole object, but each one in an array since the order matters.\n     *\n     * @exports taoItems/assets/strategies\n     */\n    var strategies = {\n\n        //the baseUrl concats the baseUrl in data if the url is relative\n        baseUrl : {\n            name : 'baseUrl',\n            handle : function handleBaseUrl(url, data){\n                if(typeof data.baseUrl === 'string' && (urlUtil.isRelative(url)) ){\n\n                    //is slashcat we manage slash concact\n                    if(data.slashcat === true){\n                        return data.baseUrl.replace(/\\/$/, '') + '/' + url.directory.replace(/^\\.\\//, '').replace(/^\\//, '')\n                            + encodeURIComponent(url.file.replace(/^\\.\\//, '').replace(/^\\//, ''));\n                    }\n\n                    return data.baseUrl + url.directory.replace(/^\\.?\\//, '') + encodeURIComponent(url.file.replace(/^\\.?\\//, ''));\n                }\n            }\n        },\n\n        //absolute URL are just left intact\n        external : {\n            name : 'external',\n            handle : function handleExternal(url, data){\n                if(urlUtil.isAbsolute(url)){\n                    return url.toString();\n                }\n            }\n        },\n\n        //the base64 encoded resources are also left intact\n        base64 : {\n            name : 'base64',\n            handle : function handleB64(url){\n                if(urlUtil.isBase64(url)){\n                    return url.toString();\n                }\n            }\n        },\n\n        //special tao media protocol\n        taomedia : {\n            name : 'taomedia',\n            handle : function handleTaoMedia(url, data){\n                //either a baseUrl is given or if empty, taomedia resources are managed as relative resources\n                var baseUrl = data.baseUrl || './';\n                if( (typeof url === 'object' && url.protocol === 'taomedia') ||\n                    (/^taomedia:\\/\\//.test(url.toString())) ){\n                    return baseUrl + url.toString();\n                }\n            }\n        }\n    };\n    return strategies;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\n */\n\ndefine('taoQtiItem/qtiCommonRenderer/renderers/config',[\n    'lodash',\n    'context',\n    'ui/themes',\n    'taoItems/assets/manager',\n    'taoItems/assets/strategies',\n], function(_, context, themes, assetManagerFactory, assetStrategies){\n    'use strict';\n\n    var itemThemes = themes.get('items');\n\n    //stratgy to resolve portable info control and portable interactions paths.\n    //It should never be reached in the stack the ususal way and should be called only using resolveBy.\n    var portableAssetStrategy = {\n        name : 'portableElementLocation',\n        handle : function handlePortableElementLocation(url){\n            if(url.source === url.relative){\n                return window.location.pathname.replace(/([^\\/]*)$/, '') + url.toString() + '/';\n            }\n        }\n    };\n\n    //Create asset manager stack\n    var assetManager = assetManagerFactory([{\n            name : 'theme',\n            handle : function handleTheme(url){\n                if(itemThemes && url.path && (url.path === itemThemes.base || _.contains(_.pluck(itemThemes.available, 'path'), url.path))){\n                    return context.root_url + url.toString();\n                }\n            }\n        },\n        assetStrategies.taomedia,\n        assetStrategies.external,\n        assetStrategies.base64,\n        assetStrategies.baseUrl,\n        portableAssetStrategy\n    ], {baseUrl : ''});\n\n    //renderers locations\n    var locations = {\n        'assessmentItem' : 'taoQtiItem/qtiCommonRenderer/renderers/Item',\n        '_container' : 'taoQtiItem/qtiCommonRenderer/renderers/Container',\n        '_simpleFeedbackRule' : false,\n        'stylesheet' : 'taoQtiItem/qtiCommonRenderer/renderers/Stylesheet',\n        'outcomeDeclaration' : false,\n        'responseDeclaration' : false,\n        'responseProcessing' : false,\n        'img' : 'taoQtiItem/qtiCommonRenderer/renderers/Img',\n        'math' : 'taoQtiItem/qtiCommonRenderer/renderers/Math',\n        'object' : 'taoQtiItem/qtiCommonRenderer/renderers/Object',\n        'rubricBlock' : 'taoQtiItem/qtiCommonRenderer/renderers/RubricBlock',\n        'modalFeedback' : 'taoQtiItem/qtiCommonRenderer/renderers/ModalFeedback',\n        'prompt' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/Prompt',\n        'choiceInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/ChoiceInteraction',\n        'extendedTextInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction',\n        'orderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/OrderInteraction',\n        'associateInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/AssociateInteraction',\n        'matchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/MatchInteraction',\n        'textEntryInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/TextEntryInteraction',\n        'sliderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/SliderInteraction',\n        'inlineChoiceInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/InlineChoiceInteraction',\n        'simpleChoice.choiceInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.ChoiceInteraction',\n        'simpleChoice.orderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.OrderInteraction',\n        'hottext' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/Hottext',\n        'gap' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/Gap',\n        'gapText' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/GapText',\n        'simpleAssociableChoice.matchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.MatchInteraction',\n        'simpleAssociableChoice.associateInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.AssociateInteraction',\n        'inlineChoice' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/InlineChoice',\n        'hottextInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/HottextInteraction',\n        'hotspotInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/HotspotInteraction',\n        'hotspotChoice' : false,\n        'gapMatchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GapMatchInteraction',\n        'selectPointInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/SelectPointInteraction',\n        'graphicOrderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicOrderInteraction',\n        'mediaInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/MediaInteraction',\n        'uploadInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/UploadInteraction',\n        'graphicGapMatchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicGapMatchInteraction',\n        'gapImg' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/GapImg',\n        'graphicAssociateInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction',\n        'associableHotspot' : false,\n        'customInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/PortableCustomInteraction',\n        'infoControl' : 'taoQtiItem/qtiCommonRenderer/renderers/PortableInfoControl',\n        'include' : 'taoQtiItem/qtiCommonRenderer/renderers/Include',\n        'endAttemptInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/EndAttemptInteraction'\n    };\n\n    return {\n        name:'commonRenderer',\n        locations: locations,\n        options:   {\n            assetManager: assetManager,\n            themes : itemThemes\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\n */\n\n/**\n * Define the Qti Item Common Renderer\n */\ndefine('taoQtiItem/qtiCommonRenderer/renderers/Renderer',[\n    'taoQtiItem/qtiRunner/core/Renderer',\n    'taoQtiItem/qtiCommonRenderer/renderers/config'\n], function(Renderer, config){\n    'use strict';\n\n    return Renderer.build(config.locations, config.name, config.options);\n});\n\n","// @license http://opensource.org/licenses/MIT\n// copyright Paul Irish 2015\n\n\n// Date.now() is supported everywhere except IE8. For IE8 we use the Date.now polyfill\n//   github.com/Financial-Times/polyfill-service/blob/master/polyfills/Date.now/polyfill.js\n// as Safari 6 doesn't have support for NavigationTiming, we use a Date.now() timestamp for relative values\n\n// if you want values similar to what you'd get with real perf.now, place this towards the head of the page\n// but in reality, you're just getting the delta between now() calls, so it's not terribly important where it's placed\n\n\n//changes (AMDify, style guide matching) by Bertrand Chevrier <bertrand@taotesting.com> for OAT S.A.\ndefine('lib/polyfill/performance-now',[], function() {\n    'use strict';\n\n    if ( !(\"performance\" in window) ){\n        window.performance = {};\n    }\n\n    Date.now = (Date.now || function() { // thanks IE8\n        return new Date().getTime();\n    });\n\n    if ( !(\"now\" in window.performance)) {\n\n        var nowOffset = Date.now();\n\n        if (window.performance.timing && window.performance.timing.navigationStart) {\n            nowOffset = window.performance.timing.navigationStart;\n        }\n\n        window.performance.now = function now() {\n            return Date.now() - nowOffset;\n        };\n    }\n});\n\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoClientDiagnostic/tools/performances/tester',[\n    'jquery',\n    'lodash',\n    'async',\n    'context',\n    'helpers',\n    'taoClientDiagnostic/tools/stats',\n    'taoQtiItem/qtiItem/core/Loader',\n    'taoQtiItem/qtiCommonRenderer/renderers/Renderer',\n    'lib/polyfill/performance-now'\n], function($, _, async, context, helpers, stats, Loader, Renderer) {\n    'use strict';\n\n    /**\n     * Duration of one second (in milliseconds)\n     * @type {Number}\n     * @private\n     */\n    var _second = 1000;\n\n    /**\n     * Default timeout duration\n     * @type {Number}\n     * @private\n     */\n    var _defaultTimeout = 30 * _second;\n\n    /**\n     * Default number of renderings by samples\n     * @type {Number}\n     * @private\n     */\n    var _defaultOccurrencesCount = 10;\n\n    /**\n     * List of default samples\n     * @type {Array}\n     */\n    var _defaultSamples = [\n        'taoClientDiagnostic/tools/performances/data/sample1/',\n        'taoClientDiagnostic/tools/performances/data/sample2/',\n        'taoClientDiagnostic/tools/performances/data/sample3/'\n    ];\n\n    /**\n     * Base text used to build sample identifiers\n     * @type {String}\n     * @private\n     */\n    var _sampleBaseId = 'sample';\n\n    /**\n     * Loads a page inside a div and compute the time to load\n     * @param {Object} data The descriptor of the page to load\n     * @param {Function} done A callback function called to provide the result\n     */\n    function loadItem(data, done){\n\n        //item location config\n        var qtiJsonFile = data.url + 'qti.json';\n        var urlTokens = data.url.split('/');\n        var extension = urlTokens[0];\n        var fullpath = require.s.contexts._.config.paths[extension];\n        var baseUrl = data.url.replace(extension, fullpath);\n        var loader = new Loader();\n        var renderer = new Renderer({\n            baseUrl : baseUrl       // compatibility mode for legacy installations\n        });\n\n        // check needed by compatibility mode for legacy installations\n        if (renderer.getAssetManager) {\n            renderer.getAssetManager().setData('baseUrl', baseUrl);\n        }\n\n        require(['json!'+qtiJsonFile], function(itemData){\n\n            loader.loadItemData(itemData, function(item){\n                renderer.load(function(){\n\n                    var $container,\n                        duration,\n                        start,\n                        end,\n                        result;\n\n                    //start right before rendering\n                    start = window.performance.now();\n\n                    //set renderer\n                    item.setRenderer(this);\n\n                    //render markup\n                    $container = $('<div>').appendTo('body');\n                    $container.append(item.render());\n\n                    //execute javascript\n                    item.postRender();\n\n                    //remove item\n                    $container.remove();\n\n                    //done\n                    end = window.performance.now();\n\n                    duration = (end - start) / _second;\n\n                    result = {\n                        id : data.id,\n                        url : data.url,\n                        duration: duration\n                    };\n\n                    done(null, result);\n\n                }, this.getLoadedClasses());\n            });\n\n        });\n\n    }\n\n    /**\n     * Performs a browser performances test by running a heavy page\n     *\n     * @param {Array} [samples]\n     * @param {Number} [occurrences]\n     * @param {Number} [timeout]\n     * @returns {Object}\n     */\n    var performancesTester = function performancesTester(samples, occurrences, timeout) {\n        var idx = 0;\n        var _samples = _.map(!_.isEmpty(samples) && samples || _defaultSamples, function(sample) {\n            idx ++;\n            return {\n                id : _sampleBaseId + idx,\n                url : sample,\n                timeout : timeout || _defaultTimeout,\n                nb : occurrences || _defaultOccurrencesCount\n            };\n        });\n\n        // add one occurrence on the first sample to obfuscate the time needed to load the runner\n        _samples[0].nb ++;\n\n        return {\n            /**\n             * Performs a performances test, then call a function to provide the result\n             * @param {Function} done\n             */\n            start: function start(done) {\n                var tests = [];\n                _.forEach(_samples, function(data) {\n                    var cb = _.partial(loadItem, data);\n                    var iterations = data.nb || 1;\n                    while (iterations --) {\n                        tests.push(cb);\n                    }\n                });\n\n                async.series(tests, function(err, measures) {\n                    var decimals = 2;\n                    var results;\n\n                    if(err && !measures.length){\n                        //something went wrong\n                        throw err;\n                    }\n\n                    // remove the first result to obfuscate the time needed to load the runner\n                    measures.shift();\n\n                    results = stats(measures, 'duration', decimals);\n\n                    done(results.average, results);\n                });\n            }\n        };\n    };\n\n    return performancesTester;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\ndefine('taoClientDiagnostic/tools/bandwidth/tester',[\n    'lodash',\n    'async',\n    'context',\n    'taoClientDiagnostic/tools/stats',\n    'taoClientDiagnostic/tools/fixedDecimals',\n    'lib/polyfill/performance-now'\n], function(_, async, context, stats, fixedDecimals) {\n    'use strict';\n\n    /**\n     * A binary kilo bytes (KiB)\n     * @type {Number}\n     * @private\n     */\n    var _kilo = 1024;\n\n    /**\n     * A binary mega bytes (MiB)\n     * @type {Number}\n     * @private\n     */\n    var _mega = _kilo * _kilo;\n\n    /**\n     * Duration of one second (in milliseconds)\n     * @type {Number}\n     * @private\n     */\n    var _second = 1000;\n\n    /**\n     * List of descriptors defining the data sets to download.\n     * - file : path of the file containing the test data\n     * - size : the given size of the file\n     * - timeout : the timeout for the download\n     * - threshold : a bandwidth threshold above which the data set can be downloaded to evaluate a more accurate value\n     * - nb : number of download iterations\n     * @type {Object}\n     */\n    var _downloadData = {\n        \"10KB\" : {\n            id : '10KB',\n            file : 'data/bin10KB.data',\n            size : 10 * _kilo,\n            timeout : _second,\n            threshold : 0,\n            nb : 10\n        },\n        \"100KB\" : {\n            id : '100KB',\n            file : 'data/bin100KB.data',\n            size : 100 * _kilo,\n            timeout : 2 * _second,\n            threshold : 0,\n            nb : 5\n        },\n        \"1MB\" : {\n            id : '1MB',\n            file : 'data/bin1MB.data',\n            size : _mega,\n            timeout : 20 * _second,\n            threshold : 0,\n            nb : 3\n        },\n        \"10MB\" : {\n            id : '10MB',\n            file : 'data/bin10MB.data',\n            size : 10 * _mega,\n            timeout : 20 * _second,\n            threshold : 8,\n            nb : 3\n        },\n        \"100MB\" : {\n            id : '100MB',\n            file : 'data/bin100MB.data',\n            size : 100 * _mega,\n            timeout : 60 * _second,\n            threshold : 20,\n            nb : 3\n        }\n    };\n\n    /**\n     * Download a data set as described by the provided descriptor and compute the duration.\n     * @param {Object} data The data set descriptor to use for download\n     * @param {Function} cb A callback function called at the end of the download.\n     * This callback is also called if a timeout breaks the download;\n     */\n    var download = function download(data, cb) {\n        var self = this;\n        var start, end;\n        var timeoutId;\n        var url;\n        var request;\n\n        if (data.threshold && this.bandwidth < data.threshold) {\n            return cb('threshold');\n        }\n\n        url = context.root_url + '/taoClientDiagnostic/views/js/tools/bandwidth/' + data.file + '?' + Date.now();\n        request = new XMLHttpRequest();\n        request.open('GET', url, true);\n        request.setRequestHeader('Accept', 'application/octet-stream');\n\n        request.onload = function onRequestLoad () {\n            var duration;\n            var bytes;\n            var seconds;\n            var speed;\n\n            end = window.performance.now();\n            clearTimeout(timeoutId);\n\n            duration = end - start;\n            bytes = data.size;\n            seconds = duration / _second;\n\n            // speed in Mbps\n            speed = ((bytes * 8) / seconds) / _mega;\n\n            self.bandwidth = Math.max(self.bandwidth, speed);\n\n            return cb(null, {\n                id : data.id,\n                file : data.file,\n                size : data.size,\n                duration : duration,\n                speed : speed\n            });\n        };\n        request.onerror = function onRequestError (err) {\n            clearTimeout(timeoutId);\n            cb(err);\n        };\n\n        timeoutId = _.delay(cb, data.timeout, 'timeout');\n        start = window.performance.now();\n        request.send();\n    };\n\n    /**\n     * Performs a bandwidth test by downloading a bunch of data sets with different sizes\n     *\n     * @returns {{start: Function}}\n     */\n    var bandwidthTester = function bandwidthTester (){\n        return {\n            /**\n             * Performs a bandwidth test, then call a function to provide the result\n             * @param {Function} done\n             */\n            start : function start(done){\n                var self = this;\n                var tests = [];\n                _.forEach(_downloadData, function(data) {\n                    var cb = _.bind(download, self, data);\n                    var iterations = data.nb || 1;\n                    while (iterations --) {\n                        tests.push(cb);\n                    }\n                });\n\n                this.bandwidth = 0;\n\n                async.series(tests, function(err, measures) {\n                    var duration = 0;\n                    var size = 0;\n                    var decimals = 2;\n                    var getValue;\n                    var results;\n\n                    if (err && !measures.length) {\n                        //something went wrong\n                        throw err;\n                    }\n\n                    getValue = function(value) {\n                        var speed = 0;\n\n                        if (value) {\n                            duration += value.duration;\n                            size += value.size;\n\n                            speed = value.speed;\n                            value.speed = fixedDecimals(speed, decimals);\n                        }\n\n                        return speed;\n                    };\n\n                    results = stats(measures, getValue, decimals);\n\n                    results.duration = fixedDecimals(duration / _second, decimals);\n                    results.size = size;\n\n                    done(results.average, results);\n                });\n            }\n        };\n    };\n\n    return bandwidthTester;\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n */\n\n/**\n *\n * @author dieter <dieter@taotesting.com>\n */\ndefine('taoClientDiagnostic/controller/CompatibilityChecker/diagnostics',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'async',\n    'helpers',\n    'layout/loading-bar',\n    'taoClientDiagnostic/tools/performances/tester',\n    'taoClientDiagnostic/tools/bandwidth/tester',\n    'ui/feedback'\n], function ($, _, __, async, helpers, loadingBar, performancesTester, bandwidthTester, feedback) {\n    'use strict';\n\n    /**\n     * The typical bandwidth needed for a test taker (Mbps)\n     * @type {Number}\n     */\n    var bandwidthUnit = 0.16;\n\n    /**\n     * The thresholds for optimal bandwidth. One by bar.\n     * @type {Array}\n     */\n    var testTakers = [\n        45\n    ];\n\n    /**\n     * Maximum number of test takers to display\n     * @type {Number}\n     */\n    var maxTestTakers = 100;\n\n    /**\n     * The threshold for optimal performances\n     * @type {Number}\n     */\n    var performanceOptimal = 0.025;\n\n    /**\n     * The threshold for minimal performances\n     * @type {Number}\n     */\n    var performanceThreshold = 0.25;\n\n    /**\n     * A list of thresholds\n     * @type {Array}\n     */\n    var thresholds = [{\n        threshold: 0,\n        message: __('Very slow performance'),\n        type: 'error'\n    }, {\n        threshold: 33,\n        message: __('Average performance'),\n        type: 'warning'\n    }, {\n        threshold: 66,\n        message: __('Good performance'),\n        type: 'success'\n    }];\n\n    /**\n     * A list of thresholds for bandwidth\n     * @type {Array}\n     */\n    var bandwidthThresholds = [{\n        threshold: 0,\n        message: __('Low bandwidth'),\n        type: 'error'\n    }, {\n        threshold: 33,\n        message: __('Average bandwidth'),\n        type: 'warning'\n    }, {\n        threshold: 66,\n        message: __('Good bandwidth'),\n        type: 'success'\n    }];\n\n    /**\n     * A list of thresholds for summary\n     * @type {Array}\n     */\n    var summaryThresholds = [{\n        threshold: 0,\n        message: __('Your system requires a compatibility update, please contact your system administrator.'),\n        type: 'error'\n    }, {\n        threshold: 33,\n        message: __('Your system is not optimal, please contact your system administrator.'),\n        type: 'warning'\n    }, {\n        threshold: 66,\n        message: __('Your system is fully compliant.'),\n        type: 'success'\n    }];\n\n    /**\n     * Gets the correct status message for a given percentage\n     * @param {Number} percentage\n     * @returns {String}\n     */\n    var getStatus = function(thresholds, percentage) {\n        var len = thresholds.length;\n        var status = thresholds[0];\n        var i, step;\n\n        percentage = Math.max(0, Math.min(100, Math.round(percentage)));\n\n        for(i = 1; i < len; i++) {\n            step = thresholds[i];\n            if (step && percentage >= step.threshold) {\n                status = step;\n            } else {\n                break;\n            }\n        }\n\n        status = _.clone(status);\n        status.percentage = percentage;\n\n        return status;\n    };\n\n    /**\n     * Gets the config related to a particular checker\n     * @param {String} name\n     * @returns {Object}\n     */\n    var getResultConfig = function(name) {\n        var $result = $('[data-result=\"' + name + '\"]');\n        var config = $result.data('config');\n        return config || {};\n    };\n\n    /**\n     * Set indicator and display bar\n     *\n     * @param {string} name\n     * @param {object} status\n     */\n    function displayTestResult(name, status) {\n        var $bar = $('[data-result=\"' + name + '\"]'),\n            $indicator = $bar.find('.quality-indicator');\n\n        $bar.find('.feedback')\n            .removeClass('feedback-error feedback-warning feedback-success')\n            .addClass('feedback-' + status.type)\n            .find('.msg').text(status.message);\n\n        $bar.find('.icon')\n            .removeClass('icon-error icon-warning icon-success')\n            .addClass('icon-' + status.type);\n\n        if (_.isNumber(status.label) || _.isString(status.label)) {\n            $indicator.attr('title', status.label);\n            $indicator.toggleClass('wide', status.label.toString().length > 2);\n        }\n\n        $bar.fadeIn(function() {\n            if($indicator.length){\n                $indicator.animate({\n                    left: (status.percentage * $bar.outerWidth() / 100) - ($indicator.outerWidth() / 2)\n                });\n            }\n        });\n    }\n\n    /**\n     * Sets a particular bar, and update the total\n     * @param {String} name\n     * @param {Object} status\n     * @param {Object} score\n     */\n    function updateTestResult(name, status, score) {\n        displayTestResult(name, status);\n        if (score) {\n            score[name] = status;\n        }\n    }\n\n    /**\n     * Displays the results summary\n     * @param {Object} score\n     */\n    function displaySummary(score) {\n        var total = _.min(score, 'percentage');\n        displayTestResult('total', getStatus(summaryThresholds, total.percentage));\n    }\n\n    /**\n     * Performs a browser checks\n     * @param {Function} done\n     */\n    function checkBrowser(done) {\n        var info = new WhichBrowser();\n        var browser = info.browser;\n        var os = info.os;\n        var information = {\n            browser: browser && browser.name || __('Unknown browser'),\n            browserVersion: browser && browser.version && browser.version.original || __('Unknown version'),\n            os: os && os.name || __('Unknown OS'),\n            osVersion: os && os.version && (os.version.alias || os.version.original) || __('Unknown version')\n        };\n\n        // which browser\n        $.post(\n            helpers._url('check', 'CompatibilityChecker', 'taoClientDiagnostic'),\n            information,\n            function(data){\n                if ('success' === data.type) {\n                    data.percentage = 100;\n                } else {\n                    data.percentage = 0;\n                }\n                done(data, information);\n            },\n            \"json\"\n        );\n    }\n\n    /**\n     * Sends the detailed stats to the server\n     * @param {String} type The type of stats\n     * @param {Object} details The stats details\n     * @param {Function} done A callback method called once server has responded\n     */\n    function storeData(type, details, done) {\n        details = _.omit(details, 'values');\n        details.type = type;\n\n        $.post(\n            helpers._url('storeData', 'CompatibilityChecker', 'taoClientDiagnostic'),\n            details,\n            done,\n            \"json\"\n        );\n    };\n\n    /**\n     * Performs a browser bandwidth check\n     * @param {Object} config\n     * @param {Number} [config.unit] - The typical bandwidth needed for a test taker (Mbps)\n     * @param {Number} [config.ideal] - The ideal number of simultaneous test takers\n     * @param {Number} [config.max] - Maximum number of test takers to display on a bar\n     * @param {Function} done\n     */\n    function checkBandwidth(config, done) {\n        var unit = config.unit || bandwidthUnit;\n        var tt = config.ideal || testTakers;\n        var maxTT = config.max || maxTestTakers;\n\n        if (!_.isArray(tt)) {\n            tt = [tt];\n        }\n\n        bandwidthTester().start(function(average, details) {\n            storeData('bandwidth', details, function(){\n                var status = [];\n\n                _.forEach(tt, function(threshold) {\n                    var max = threshold * unit;\n                    var st = getStatus(bandwidthThresholds, details.max / max * 100);\n                    var nb = Math.floor(details.max / unit);\n\n                    if (nb > maxTT) {\n                        nb = '>' + maxTT;\n                    }\n\n                    st.label = nb;\n                    status.push(st);\n                });\n\n                done(status, details);\n            });\n        });\n    }\n\n    /**\n     * Performs a browser performances check\n     * @param {Object} config\n     * @param {Array} [config.samples] - A list of samples to render in order to compute the rendering performances\n     * @param {Number} [config.occurrences] - The number of renderings by samples\n     * @param {Number} [config.timeout] - Max allowed duration for a sample rendering\n     * @param {Number} [config.optimal] - The threshold for optimal performances\n     * @param {Number} [config.threshold] - The threshold for minimal performances\n     * @param {Function} done\n     */\n    function checkPerformance(config, done) {\n        var optimal = config.optimal || performanceOptimal;\n        var range = Math.abs(optimal - (config.threshold || performanceThreshold));\n\n        performancesTester(config.samples, config.occurrences, config.timeout * 1000).start(function(average, details) {\n            var cursor = range - average + optimal;\n            var status = getStatus(thresholds, cursor / range * 100);\n\n            storeData('performance', details, function(){\n                done(status, details);\n            });\n        });\n    }\n\n    /**\n     * Updates the displayed details\n     * @param {Object} information\n     */\n    function displayDetails(information) {\n        var $detailsTable = $('#details');\n        $('tbody', $detailsTable).empty();\n        $.each(information, function(index, object) {\n            var line = '<td>'+ object.message +'</td><td>'+ object.value +'</td>';\n            $('tbody', $detailsTable).append('<tr>' + line + '</tr>');\n        });\n    }\n\n    /**\n     *\n     */\n    var init = function init(){\n        var $testTriggerBtn = $('[data-action=\"test-launcher\"]');\n        var $detailsBtn = $('[data-action=\"display-details\"]');\n        var status, information = {};\n        var scores = {};\n        var $feedbackBox = $('#feedback-box');\n\n        $testTriggerBtn.on('click', function(){\n            loadingBar.start();\n            $testTriggerBtn.hide();\n\n            async.series([function(cb) {\n                checkBrowser(function(status, details) {\n                    _.assign(information, {\n                        browser: {message: __('Web browser'), value: details.browser + ' ' + details.browserVersion},\n                        os: {message: __('Operating system'), value: details.os + ' ' + details.osVersion}\n                    });\n                    displayDetails(information);\n                    updateTestResult('browser', status, scores);\n                    cb();\n                });\n            }, function(cb) {\n                checkPerformance(getResultConfig('performance'), function(status, details) {\n                    _.assign(information, {\n                        performancesMin : {message : __('Minimum rendering time'), value:details.min + ' s'},\n                        performancesMax : {message : __('Maximum rendering time'), value:details.max + ' s'},\n                        performancesAverage : {message : __('Average rendering time'), value:details.average + ' s'}\n                    });\n                    displayDetails(information);\n                    updateTestResult('performance', status, scores);\n                    cb();\n                });\n            }, function(cb) {\n                checkBandwidth(getResultConfig('bandwidth-0'), function(status, details) {\n                    _.assign(information, {\n                        bandwidthMin : {message : __('Minimum bandwidth'), value:details.min + ' Mbps'},\n                        bandwidthMax : {message : __('Maximum bandwidth'), value:details.max + ' Mbps'},\n                        bandwidthAverage : {message : __('Average bandwidth'), value:details.average + ' Mbps'}\n                    });\n                    displayDetails(information);\n\n                    _.forEach(status, function(st, i) {\n                        updateTestResult('bandwidth-' + i, st, scores);\n                    });\n\n                    cb();\n                });\n            }], function() {\n                displaySummary(scores);\n                loadingBar.stop();\n            });\n        });\n\n        $detailsBtn.on('click', function() {\n            loadingBar.start();\n            $detailsBtn.hide();\n\n            displayDetails(information);\n\n            status = getStatus(thresholds, 68);\n            displayTestResult('details', status);\n\n            loadingBar.stop();\n        });\n\n\n        if(!!$feedbackBox.data('error')){\n            feedback().error($feedbackBox.data('error'));\n        }\n        if($feedbackBox.data('message')){\n            feedback().error($feedbackBox.data('message'));\n        }\n    };\n\n    /**\n     * @exports\n     */\n    return init();\n});\n\n"]}